!function e(n,t,r){function i(u,a){if(!t[u]){if(!n[u]){var s="function"==typeof require&&require;if(!a&&s)return s(u,!0);if(o)return o(u,!0);var l=new Error("Cannot find module '"+u+"'");throw l.code="MODULE_NOT_FOUND",l}var c=t[u]={exports:{}};n[u][0].call(c.exports,function(e){var t=n[u][1][e];return i(t?t:e)},c,c.exports,e,n,t,r)}return t[u].exports}for(var o="function"==typeof require&&require,u=0;u<r.length;u++)i(r[u]);return i}({1:[function(e,n,t){(function(e){(function(){function r(e,n,t){for(var r=(t||0)-1,i=e?e.length:0;++r<i;)if(e[r]===n)return r;return-1}function i(e,n){var t=typeof n;if(e=e.cache,"boolean"==t||null==n)return e[n]?0:-1;"number"!=t&&"string"!=t&&(t="object");var i="number"==t?n:b+n;return e=(e=e[t])&&e[i],"object"==t?e&&r(e,n)>-1?0:-1:e?0:-1}function o(e){var n=this.cache,t=typeof e;if("boolean"==t||null==e)n[e]=!0;else{"number"!=t&&"string"!=t&&(t="object");var r="number"==t?e:b+e,i=n[t]||(n[t]={});"object"==t?(i[r]||(i[r]=[])).push(e):i[r]=!0}}function u(e){return e.charCodeAt(0)}function a(e,n){for(var t=e.criteria,r=n.criteria,i=-1,o=t.length;++i<o;){var u=t[i],a=r[i];if(u!==a){if(u>a||"undefined"==typeof u)return 1;if(a>u||"undefined"==typeof a)return-1}}return e.index-n.index}function s(e){var n=-1,t=e.length,r=e[0],i=e[t/2|0],u=e[t-1];if(r&&"object"==typeof r&&i&&"object"==typeof i&&u&&"object"==typeof u)return!1;var a=f();a["false"]=a["null"]=a["true"]=a.undefined=!1;var s=f();for(s.array=e,s.cache=a,s.push=o;++n<t;)s.push(e[n]);return s}function l(e){return"\\"+Z[e]}function c(){return y.pop()||[]}function f(){return x.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,value:null}}function h(e){e.length=0,y.length<E&&y.push(e)}function d(e){var n=e.cache;n&&d(n),e.array=e.cache=e.criteria=e.object=e.number=e.string=e.value=null,x.length<E&&x.push(e)}function p(e,n,t){n||(n=0),"undefined"==typeof t&&(t=e?e.length:0);for(var r=-1,i=t-n||0,o=Array(0>i?0:i);++r<i;)o[r]=e[n+r];return o}function g(e){function n(e){return e&&"object"==typeof e&&!$r(e)&&jr.call(e,"__wrapped__")?e:new t(e)}function t(e,n){this.__chain__=!!n,this.__wrapped__=e}function o(e){function n(){if(r){var e=p(r);Ar.apply(e,arguments)}if(this instanceof n){var o=x(t.prototype),u=t.apply(o,e||arguments);return Cn(u)?u:o}return t.apply(i,e||arguments)}var t=e[0],r=e[2],i=e[4];return Kr(n,e),n}function y(e,n,t,r,i){if(t){var o=t(e);if("undefined"!=typeof o)return o}var u=Cn(e);if(!u)return e;var a=wr.call(e);if(!q[a])return e;var s=Qr[a];switch(a){case B:case z:return new s(+e);case U:case W:return new s(e);case G:return o=s(e.source,O.exec(e)),o.lastIndex=e.lastIndex,o}var l=$r(e);if(n){var f=!r;r||(r=c()),i||(i=c());for(var d=r.length;d--;)if(r[d]==e)return i[d];o=l?s(e.length):{}}else o=l?p(e):oi({},e);return l&&(jr.call(e,"index")&&(o.index=e.index),jr.call(e,"input")&&(o.input=e.input)),n?(r.push(e),i.push(o),(l?Kn:si)(e,function(e,u){o[u]=y(e,n,t,r,i)}),f&&(h(r),h(i)),o):o}function x(e){return Cn(e)?zr(e):{}}function E(e,n,t){if("function"!=typeof e)return $t;if("undefined"==typeof n||!("prototype"in e))return e;var r=e.__bindData__;if("undefined"==typeof r&&(Zr.funcNames&&(r=!e.name),r=r||!Zr.funcDecomp,!r)){var i=kr.call(e);Zr.funcNames||(r=!L.test(i)),r||(r=P.test(i),Kr(e,r))}if(r===!1||r!==!0&&1&r[1])return e;switch(t){case 1:return function(t){return e.call(n,t)};case 2:return function(t,r){return e.call(n,t,r)};case 3:return function(t,r,i){return e.call(n,t,r,i)};case 4:return function(t,r,i,o){return e.call(n,t,r,i,o)}}return At(e,n)}function Z(e){function n(){var e=s?u:this;if(i){var d=p(i);Ar.apply(d,arguments)}if((o||c)&&(d||(d=p(arguments)),o&&Ar.apply(d,o),c&&d.length<a))return r|=16,Z([t,f?r:-4&r,d,null,u,a]);if(d||(d=arguments),l&&(t=e[h]),this instanceof n){e=x(t.prototype);var g=t.apply(e,d);return Cn(g)?g:e}return t.apply(e,d)}var t=e[0],r=e[1],i=e[2],o=e[3],u=e[4],a=e[5],s=1&r,l=2&r,c=4&r,f=8&r,h=t;return Kr(n,e),n}function $(e,n){var t=-1,o=ln(),u=e?e.length:0,a=u>=_&&o===r,l=[];if(a){var c=s(n);c?(o=i,n=c):a=!1}for(;++t<u;){var f=e[t];o(n,f)<0&&l.push(f)}return a&&d(n),l}function J(e,n,t,r){for(var i=(r||0)-1,o=e?e.length:0,u=[];++i<o;){var a=e[i];if(a&&"object"==typeof a&&"number"==typeof a.length&&($r(a)||dn(a))){n||(a=J(a,n,t));var s=-1,l=a.length,c=u.length;for(u.length+=l;++s<l;)u[c++]=a[s]}else t||u.push(a)}return u}function en(e,n,t,r,i,o){if(t){var u=t(e,n);if("undefined"!=typeof u)return!!u}if(e===n)return 0!==e||1/e==1/n;var a=typeof e,s=typeof n;if(!(e!==e||e&&Q[a]||n&&Q[s]))return!1;if(null==e||null==n)return e===n;var l=wr.call(e),f=wr.call(n);if(l==D&&(l=V),f==D&&(f=V),l!=f)return!1;switch(l){case B:case z:return+e==+n;case U:return e!=+e?n!=+n:0==e?1/e==1/n:e==+n;case G:case W:return e==Er(n)}var d=l==M;if(!d){var p=jr.call(e,"__wrapped__"),g=jr.call(n,"__wrapped__");if(p||g)return en(p?e.__wrapped__:e,g?n.__wrapped__:n,t,r,i,o);if(l!=V)return!1;var v=e.constructor,y=n.constructor;if(v!=y&&!(Nn(v)&&v instanceof v&&Nn(y)&&y instanceof y)&&"constructor"in e&&"constructor"in n)return!1}var x=!i;i||(i=c()),o||(o=c());for(var m=i.length;m--;)if(i[m]==e)return o[m]==n;var b=0;if(u=!0,i.push(e),o.push(n),d){if(m=e.length,b=n.length,u=b==m,u||r)for(;b--;){var _=m,E=n[b];if(r)for(;_--&&!(u=en(e[_],E,t,r,i,o)););else if(!(u=en(e[b],E,t,r,i,o)))break}}else ai(n,function(n,a,s){return jr.call(s,a)?(b++,u=jr.call(e,a)&&en(e[a],n,t,r,i,o)):void 0}),u&&!r&&ai(e,function(e,n,t){return jr.call(t,n)?u=--b>-1:void 0});return i.pop(),o.pop(),x&&(h(i),h(o)),u}function nn(e,n,t,r,i){($r(n)?Kn:si)(n,function(n,o){var u,a,s=n,l=e[o];if(n&&((a=$r(n))||li(n))){for(var c=r.length;c--;)if(u=r[c]==n){l=i[c];break}if(!u){var f;t&&(s=t(l,n),(f="undefined"!=typeof s)&&(l=s)),f||(l=a?$r(l)?l:[]:li(l)?l:{}),r.push(n),i.push(l),f||nn(l,n,t,r,i)}}else t&&(s=t(l,n),"undefined"==typeof s&&(s=n)),"undefined"!=typeof s&&(l=s);e[o]=l})}function rn(e,n){return e+Cr(Xr()*(n-e+1))}function on(e,n,t){var o=-1,u=ln(),a=e?e.length:0,l=[],f=!n&&a>=_&&u===r,p=t||f?c():l;if(f){var g=s(p);u=i,p=g}for(;++o<a;){var v=e[o],y=t?t(v,o,e):v;(n?!o||p[p.length-1]!==y:u(p,y)<0)&&((t||f)&&p.push(y),l.push(v))}return f?(h(p.array),d(p)):t&&h(p),l}function un(e){return function(t,r,i){var o={};r=n.createCallback(r,i,3);var u=-1,a=t?t.length:0;if("number"==typeof a)for(;++u<a;){var s=t[u];e(o,s,r(s,u,t),t)}else si(t,function(n,t,i){e(o,n,r(n,t,i),i)});return o}}function an(e,n,t,r,i,u){var a=1&n,s=2&n,l=4&n,c=16&n,f=32&n;if(!s&&!Nn(e))throw new Tr;c&&!t.length&&(n&=-17,c=t=!1),f&&!r.length&&(n&=-33,f=r=!1);var h=e&&e.__bindData__;if(h&&h!==!0)return h=p(h),h[2]&&(h[2]=p(h[2])),h[3]&&(h[3]=p(h[3])),!a||1&h[1]||(h[4]=i),!a&&1&h[1]&&(n|=8),!l||4&h[1]||(h[5]=u),c&&Ar.apply(h[2]||(h[2]=[]),t),f&&Mr.apply(h[3]||(h[3]=[]),r),h[1]|=n,an.apply(null,h);var d=1==n||17===n?o:Z;return d([e,n,t,r,i,u])}function sn(e){return ni[e]}function ln(){var e=(e=n.indexOf)===xt?r:e;return e}function cn(e){return"function"==typeof e&&Or.test(e)}function fn(e){var n,t;return e&&wr.call(e)==V&&(n=e.constructor,!Nn(n)||n instanceof n)?(ai(e,function(e,n){t=n}),"undefined"==typeof t||jr.call(e,t)):!1}function hn(e){return ti[e]}function dn(e){return e&&"object"==typeof e&&"number"==typeof e.length&&wr.call(e)==D||!1}function pn(e,n,t,r){return"boolean"!=typeof n&&null!=n&&(r=t,t=n,n=!1),y(e,n,"function"==typeof t&&E(t,r,1))}function gn(e,n,t){return y(e,!0,"function"==typeof n&&E(n,t,1))}function vn(e,n){var t=x(e);return n?oi(t,n):t}function yn(e,t,r){var i;return t=n.createCallback(t,r,3),si(e,function(e,n,r){return t(e,n,r)?(i=n,!1):void 0}),i}function xn(e,t,r){var i;return t=n.createCallback(t,r,3),bn(e,function(e,n,r){return t(e,n,r)?(i=n,!1):void 0}),i}function mn(e,n,t){var r=[];ai(e,function(e,n){r.push(n,e)});var i=r.length;for(n=E(n,t,3);i--&&n(r[i--],r[i],e)!==!1;);return e}function bn(e,n,t){var r=ei(e),i=r.length;for(n=E(n,t,3);i--;){var o=r[i];if(n(e[o],o,e)===!1)break}return e}function _n(e){var n=[];return ai(e,function(e,t){Nn(e)&&n.push(t)}),n.sort()}function En(e,n){return e?jr.call(e,n):!1}function Tn(e){for(var n=-1,t=ei(e),r=t.length,i={};++n<r;){var o=t[n];i[e[o]]=o}return i}function Sn(e){return e===!0||e===!1||e&&"object"==typeof e&&wr.call(e)==B||!1}function In(e){return e&&"object"==typeof e&&wr.call(e)==z||!1}function Rn(e){return e&&1===e.nodeType||!1}function wn(e){var n=!0;if(!e)return n;var t=wr.call(e),r=e.length;return t==M||t==W||t==D||t==V&&"number"==typeof r&&Nn(e.splice)?!r:(si(e,function(){return n=!1}),n)}function On(e,n,t,r){return en(e,n,"function"==typeof t&&E(t,r,2))}function Ln(e){return Ur(e)&&!Vr(parseFloat(e))}function Nn(e){return"function"==typeof e}function Cn(e){return!(!e||!Q[typeof e])}function kn(e){return jn(e)&&e!=+e}function Pn(e){return null===e}function jn(e){return"number"==typeof e||e&&"object"==typeof e&&wr.call(e)==U||!1}function An(e){return e&&"object"==typeof e&&wr.call(e)==G||!1}function Fn(e){return"string"==typeof e||e&&"object"==typeof e&&wr.call(e)==W||!1}function Dn(e){return"undefined"==typeof e}function Mn(e,t,r){var i={};return t=n.createCallback(t,r,3),si(e,function(e,n,r){i[n]=t(e,n,r)}),i}function Bn(e){var n=arguments,t=2;if(!Cn(e))return e;if("number"!=typeof n[2]&&(t=n.length),t>3&&"function"==typeof n[t-2])var r=E(n[--t-1],n[t--],2);else t>2&&"function"==typeof n[t-1]&&(r=n[--t]);for(var i=p(arguments,1,t),o=-1,u=c(),a=c();++o<t;)nn(e,i[o],r,u,a);return h(u),h(a),e}function zn(e,t,r){var i={};if("function"!=typeof t){var o=[];ai(e,function(e,n){o.push(n)}),o=$(o,J(arguments,!0,!1,1));for(var u=-1,a=o.length;++u<a;){var s=o[u];i[s]=e[s]}}else t=n.createCallback(t,r,3),ai(e,function(e,n,r){t(e,n,r)||(i[n]=e)});return i}function Hn(e){for(var n=-1,t=ei(e),r=t.length,i=pr(r);++n<r;){var o=t[n];i[n]=[o,e[o]]}return i}function Un(e,t,r){var i={};if("function"!=typeof t)for(var o=-1,u=J(arguments,!0,!1,1),a=Cn(e)?u.length:0;++o<a;){var s=u[o];s in e&&(i[s]=e[s])}else t=n.createCallback(t,r,3),ai(e,function(e,n,r){t(e,n,r)&&(i[n]=e)});return i}function Vn(e,t,r,i){var o=$r(e);if(null==r)if(o)r=[];else{var u=e&&e.constructor,a=u&&u.prototype;r=x(a)}return t&&(t=n.createCallback(t,i,4),(o?Kn:si)(e,function(e,n,i){return t(r,e,n,i)})),r}function Gn(e){for(var n=-1,t=ei(e),r=t.length,i=pr(r);++n<r;)i[n]=e[t[n]];return i}function Wn(e){for(var n=arguments,t=-1,r=J(n,!0,!1,1),i=n[2]&&n[2][n[1]]===e?1:r.length,o=pr(i);++t<i;)o[t]=e[r[t]];return o}function qn(e,n,t){var r=-1,i=ln(),o=e?e.length:0,u=!1;return t=(0>t?Wr(0,o+t):t)||0,$r(e)?u=i(e,n,t)>-1:"number"==typeof o?u=(Fn(e)?e.indexOf(n,t):i(e,n,t))>-1:si(e,function(e){return++r>=t?!(u=e===n):void 0}),u}function Yn(e,t,r){var i=!0;t=n.createCallback(t,r,3);var o=-1,u=e?e.length:0;if("number"==typeof u)for(;++o<u&&(i=!!t(e[o],o,e)););else si(e,function(e,n,r){return i=!!t(e,n,r)});return i}function Xn(e,t,r){var i=[];t=n.createCallback(t,r,3);var o=-1,u=e?e.length:0;if("number"==typeof u)for(;++o<u;){var a=e[o];t(a,o,e)&&i.push(a)}else si(e,function(e,n,r){t(e,n,r)&&i.push(e)});return i}function Qn(e,t,r){t=n.createCallback(t,r,3);var i=-1,o=e?e.length:0;if("number"!=typeof o){var u;return si(e,function(e,n,r){return t(e,n,r)?(u=e,!1):void 0}),u}for(;++i<o;){var a=e[i];if(t(a,i,e))return a}}function Zn(e,t,r){var i;return t=n.createCallback(t,r,3),$n(e,function(e,n,r){return t(e,n,r)?(i=e,!1):void 0}),i}function Kn(e,n,t){var r=-1,i=e?e.length:0;if(n=n&&"undefined"==typeof t?n:E(n,t,3),"number"==typeof i)for(;++r<i&&n(e[r],r,e)!==!1;);else si(e,n);return e}function $n(e,n,t){var r=e?e.length:0;if(n=n&&"undefined"==typeof t?n:E(n,t,3),"number"==typeof r)for(;r--&&n(e[r],r,e)!==!1;);else{var i=ei(e);r=i.length,si(e,function(e,t,o){return t=i?i[--r]:--r,n(o[t],t,o)})}return e}function Jn(e,n){var t=p(arguments,2),r=-1,i="function"==typeof n,o=e?e.length:0,u=pr("number"==typeof o?o:0);return Kn(e,function(e){u[++r]=(i?n:e[n]).apply(e,t)}),u}function et(e,t,r){var i=-1,o=e?e.length:0;if(t=n.createCallback(t,r,3),"number"==typeof o)for(var u=pr(o);++i<o;)u[i]=t(e[i],i,e);else u=[],si(e,function(e,n,r){u[++i]=t(e,n,r)});return u}function nt(e,t,r){var i=-1/0,o=i;if("function"!=typeof t&&r&&r[t]===e&&(t=null),null==t&&$r(e))for(var a=-1,s=e.length;++a<s;){var l=e[a];l>o&&(o=l)}else t=null==t&&Fn(e)?u:n.createCallback(t,r,3),Kn(e,function(e,n,r){var u=t(e,n,r);u>i&&(i=u,o=e)});return o}function tt(e,t,r){var i=1/0,o=i;if("function"!=typeof t&&r&&r[t]===e&&(t=null),null==t&&$r(e))for(var a=-1,s=e.length;++a<s;){var l=e[a];o>l&&(o=l)}else t=null==t&&Fn(e)?u:n.createCallback(t,r,3),Kn(e,function(e,n,r){var u=t(e,n,r);i>u&&(i=u,o=e)});return o}function rt(e,t,r,i){if(!e)return r;var o=arguments.length<3;t=n.createCallback(t,i,4);var u=-1,a=e.length;if("number"==typeof a)for(o&&(r=e[++u]);++u<a;)r=t(r,e[u],u,e);else si(e,function(e,n,i){r=o?(o=!1,e):t(r,e,n,i)});return r}function it(e,t,r,i){var o=arguments.length<3;return t=n.createCallback(t,i,4),$n(e,function(e,n,i){r=o?(o=!1,e):t(r,e,n,i)}),r}function ot(e,t,r){return t=n.createCallback(t,r,3),Xn(e,function(e,n,r){return!t(e,n,r)})}function ut(e,n,t){if(e&&"number"!=typeof e.length&&(e=Gn(e)),null==n||t)return e?e[rn(0,e.length-1)]:v;var r=at(e);return r.length=qr(Wr(0,n),r.length),r}function at(e){var n=-1,t=e?e.length:0,r=pr("number"==typeof t?t:0);return Kn(e,function(e){var t=rn(0,++n);r[n]=r[t],r[t]=e}),r}function st(e){var n=e?e.length:0;return"number"==typeof n?n:ei(e).length}function lt(e,t,r){var i;t=n.createCallback(t,r,3);var o=-1,u=e?e.length:0;if("number"==typeof u)for(;++o<u&&!(i=t(e[o],o,e)););else si(e,function(e,n,r){return!(i=t(e,n,r))});return!!i}function ct(e,t,r){var i=-1,o=$r(t),u=e?e.length:0,s=pr("number"==typeof u?u:0);for(o||(t=n.createCallback(t,r,3)),Kn(e,function(e,n,r){var u=s[++i]=f();o?u.criteria=et(t,function(n){return e[n]}):(u.criteria=c())[0]=t(e,n,r),u.index=i,u.value=e}),u=s.length,s.sort(a);u--;){var l=s[u];s[u]=l.value,o||h(l.criteria),d(l)}return s}function ft(e){return e&&"number"==typeof e.length?p(e):Gn(e)}function ht(e){for(var n=-1,t=e?e.length:0,r=[];++n<t;){var i=e[n];i&&r.push(i)}return r}function dt(e){return $(e,J(arguments,!0,!0,1))}function pt(e,t,r){var i=-1,o=e?e.length:0;for(t=n.createCallback(t,r,3);++i<o;)if(t(e[i],i,e))return i;return-1}function gt(e,t,r){var i=e?e.length:0;for(t=n.createCallback(t,r,3);i--;)if(t(e[i],i,e))return i;return-1}function vt(e,t,r){var i=0,o=e?e.length:0;if("number"!=typeof t&&null!=t){var u=-1;for(t=n.createCallback(t,r,3);++u<o&&t(e[u],u,e);)i++}else if(i=t,null==i||r)return e?e[0]:v;return p(e,0,qr(Wr(0,i),o))}function yt(e,n,t,r){return"boolean"!=typeof n&&null!=n&&(r=t,t="function"!=typeof n&&r&&r[n]===e?null:n,n=!1),null!=t&&(e=et(e,t,r)),J(e,n)}function xt(e,n,t){if("number"==typeof t){var i=e?e.length:0;t=0>t?Wr(0,i+t):t||0}else if(t){var o=wt(e,n);return e[o]===n?o:-1}return r(e,n,t)}function mt(e,t,r){var i=0,o=e?e.length:0;if("number"!=typeof t&&null!=t){var u=o;for(t=n.createCallback(t,r,3);u--&&t(e[u],u,e);)i++}else i=null==t||r?1:t||i;return p(e,0,qr(Wr(0,o-i),o))}function bt(){for(var e=[],n=-1,t=arguments.length,o=c(),u=ln(),a=u===r,l=c();++n<t;){var f=arguments[n];($r(f)||dn(f))&&(e.push(f),o.push(a&&f.length>=_&&s(n?e[n]:l)))}var p=e[0],g=-1,v=p?p.length:0,y=[];e:for(;++g<v;){var x=o[0];if(f=p[g],(x?i(x,f):u(l,f))<0){for(n=t,(x||l).push(f);--n;)if(x=o[n],(x?i(x,f):u(e[n],f))<0)continue e;y.push(f)}}for(;t--;)x=o[t],x&&d(x);return h(o),h(l),y}function _t(e,t,r){var i=0,o=e?e.length:0;if("number"!=typeof t&&null!=t){var u=o;for(t=n.createCallback(t,r,3);u--&&t(e[u],u,e);)i++}else if(i=t,null==i||r)return e?e[o-1]:v;return p(e,Wr(0,o-i))}function Et(e,n,t){var r=e?e.length:0;for("number"==typeof t&&(r=(0>t?Wr(0,r+t):qr(t,r-1))+1);r--;)if(e[r]===n)return r;return-1}function Tt(e){for(var n=arguments,t=0,r=n.length,i=e?e.length:0;++t<r;)for(var o=-1,u=n[t];++o<i;)e[o]===u&&(Dr.call(e,o--,1),i--);return e}function St(e,n,t){e=+e||0,t="number"==typeof t?t:+t||1,null==n&&(n=e,e=0);for(var r=-1,i=Wr(0,Lr((n-e)/(t||1))),o=pr(i);++r<i;)o[r]=e,e+=t;return o}function It(e,t,r){var i=-1,o=e?e.length:0,u=[];for(t=n.createCallback(t,r,3);++i<o;){var a=e[i];t(a,i,e)&&(u.push(a),Dr.call(e,i--,1),o--)}return u}function Rt(e,t,r){if("number"!=typeof t&&null!=t){var i=0,o=-1,u=e?e.length:0;for(t=n.createCallback(t,r,3);++o<u&&t(e[o],o,e);)i++}else i=null==t||r?1:Wr(0,t);return p(e,i)}function wt(e,t,r,i){var o=0,u=e?e.length:o;for(r=r?n.createCallback(r,i,1):$t,t=r(t);u>o;){var a=o+u>>>1;r(e[a])<t?o=a+1:u=a}return o}function Ot(){return on(J(arguments,!0,!0))}function Lt(e,t,r,i){return"boolean"!=typeof t&&null!=t&&(i=r,r="function"!=typeof t&&i&&i[t]===e?null:t,t=!1),null!=r&&(r=n.createCallback(r,i,3)),on(e,t,r)}function Nt(e){return $(e,p(arguments,1))}function Ct(){for(var e=-1,n=arguments.length;++e<n;){var t=arguments[e];if($r(t)||dn(t))var r=r?on($(r,t).concat($(t,r))):t}return r||[]}function kt(){for(var e=arguments.length>1?arguments:arguments[0],n=-1,t=e?nt(di(e,"length")):0,r=pr(0>t?0:t);++n<t;)r[n]=di(e,n);return r}function Pt(e,n){var t=-1,r=e?e.length:0,i={};for(n||!r||$r(e[0])||(n=[]);++t<r;){var o=e[t];n?i[o]=n[t]:o&&(i[o[0]]=o[1])}return i}function jt(e,n){if(!Nn(n))throw new Tr;return function(){return--e<1?n.apply(this,arguments):void 0}}function At(e,n){return arguments.length>2?an(e,17,p(arguments,2),null,n):an(e,1,null,null,n)}function Ft(e){for(var n=arguments.length>1?J(arguments,!0,!1,1):_n(e),t=-1,r=n.length;++t<r;){var i=n[t];e[i]=an(e[i],1,null,null,e)}return e}function Dt(e,n){return arguments.length>2?an(n,19,p(arguments,2),null,e):an(n,3,null,null,e)}function Mt(){for(var e=arguments,n=e.length;n--;)if(!Nn(e[n]))throw new Tr;return function(){for(var n=arguments,t=e.length;t--;)n=[e[t].apply(this,n)];return n[0]}}function Bt(e,n){return n="number"==typeof n?n:+n||e.length,an(e,4,null,null,null,n)}function zt(e,n,t){var r,i,o,u,a,s,l,c=0,f=!1,h=!0;if(!Nn(e))throw new Tr;if(n=Wr(0,n)||0,t===!0){var d=!0;h=!1}else Cn(t)&&(d=t.leading,f="maxWait"in t&&(Wr(n,t.maxWait)||0),h="trailing"in t?t.trailing:h);var p=function(){var t=n-(gi()-u);if(0>=t){i&&Nr(i);var f=l;i=s=l=v,f&&(c=gi(),o=e.apply(a,r),s||i||(r=a=null))}else s=Fr(p,t)},g=function(){s&&Nr(s),i=s=l=v,(h||f!==n)&&(c=gi(),o=e.apply(a,r),s||i||(r=a=null))};return function(){if(r=arguments,u=gi(),a=this,l=h&&(s||!d),f===!1)var t=d&&!s;else{i||d||(c=u);var v=f-(u-c),y=0>=v;y?(i&&(i=Nr(i)),c=u,o=e.apply(a,r)):i||(i=Fr(g,v))}return y&&s?s=Nr(s):s||n===f||(s=Fr(p,n)),t&&(y=!0,o=e.apply(a,r)),!y||s||i||(r=a=null),o}}function Ht(e){if(!Nn(e))throw new Tr;var n=p(arguments,1);return Fr(function(){e.apply(v,n)},1)}function Ut(e,n){if(!Nn(e))throw new Tr;var t=p(arguments,2);return Fr(function(){e.apply(v,t)},n)}function Vt(e,n){if(!Nn(e))throw new Tr;var t=function(){var r=t.cache,i=n?n.apply(this,arguments):b+arguments[0];return jr.call(r,i)?r[i]:r[i]=e.apply(this,arguments)};return t.cache={},t}function Gt(e){var n,t;if(!Nn(e))throw new Tr;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}}function Wt(e){return an(e,16,p(arguments,1))}function qt(e){return an(e,32,null,p(arguments,1))}function Yt(e,n,t){var r=!0,i=!0;if(!Nn(e))throw new Tr;return t===!1?r=!1:Cn(t)&&(r="leading"in t?t.leading:r,i="trailing"in t?t.trailing:i),Y.leading=r,Y.maxWait=n,Y.trailing=i,zt(e,n,Y)}function Xt(e,n){return an(n,16,[e])}function Qt(e){return function(){return e}}function Zt(e,n,t){var r=typeof e;if(null==e||"function"==r)return E(e,n,t);if("object"!=r)return tr(e);var i=ei(e),o=i[0],u=e[o];return 1!=i.length||u!==u||Cn(u)?function(n){for(var t=i.length,r=!1;t--&&(r=en(n[i[t]],e[i[t]],null,!0)););return r}:function(e){var n=e[o];return u===n&&(0!==u||1/u==1/n)}}function Kt(e){return null==e?"":Er(e).replace(ii,sn)}function $t(e){return e}function Jt(e,r,i){var o=!0,u=r&&_n(r);r&&(i||u.length)||(null==i&&(i=r),a=t,r=e,e=n,u=_n(r)),i===!1?o=!1:Cn(i)&&"chain"in i&&(o=i.chain);var a=e,s=Nn(a);Kn(u,function(n){var t=e[n]=r[n];s&&(a.prototype[n]=function(){var n=this.__chain__,r=this.__wrapped__,i=[r];Ar.apply(i,arguments);var u=t.apply(e,i);if(o||n){if(r===u&&Cn(u))return this;u=new a(u),u.__chain__=n}return u})})}function er(){return e._=Rr,this}function nr(){}function tr(e){return function(n){return n[e]}}function rr(e,n,t){var r=null==e,i=null==n;if(null==t&&("boolean"==typeof e&&i?(t=e,e=1):i||"boolean"!=typeof n||(t=n,i=!0)),r&&i&&(n=1),e=+e||0,i?(n=e,e=0):n=+n||0,t||e%1||n%1){var o=Xr();return qr(e+o*(n-e+parseFloat("1e-"+((o+"").length-1))),n)}return rn(e,n)}function ir(e,n){if(e){var t=e[n];return Nn(t)?e[n]():t}}function or(e,t,r){var i=n.templateSettings;e=Er(e||""),r=ui({},r,i);var o,u=ui({},r.imports,i.imports),a=ei(u),s=Gn(u),c=0,f=r.interpolate||k,h="__p += '",d=_r((r.escape||k).source+"|"+f.source+"|"+(f===N?w:k).source+"|"+(r.evaluate||k).source+"|$","g");e.replace(d,function(n,t,r,i,u,a){return r||(r=i),h+=e.slice(c,a).replace(j,l),t&&(h+="' +\n__e("+t+") +\n'"),u&&(o=!0,h+="';\n"+u+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),c=a+n.length,n}),h+="';\n";var p=r.variable,g=p;g||(p="obj",h="with ("+p+") {\n"+h+"\n}\n"),h=(o?h.replace(S,""):h).replace(I,"$1").replace(R,"$1;"),h="function("+p+") {\n"+(g?"":p+" || ("+p+" = {});\n")+"var __t, __p = '', __e = _.escape"+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var y="\n/*\n//# sourceURL="+(r.sourceURL||"/lodash/template/source["+F++ +"]")+"\n*/";try{var x=yr(a,"return "+h+y).apply(v,s)}catch(m){throw m.source=h,m}return t?x(t):(x.source=h,x)}function ur(e,n,t){e=(e=+e)>-1?e:0;var r=-1,i=pr(e);for(n=E(n,t,1);++r<e;)i[r]=n(r);return i}function ar(e){return null==e?"":Er(e).replace(ri,hn)}function sr(e){var n=++m;return Er(null==e?"":e)+n}function lr(e){return e=new t(e),e.__chain__=!0,e}function cr(e,n){return n(e),e}function fr(){return this.__chain__=!0,this}function hr(){return Er(this.__wrapped__)}function dr(){return this.__wrapped__}e=e?tn.defaults(K.Object(),e,tn.pick(K,A)):K;var pr=e.Array,gr=e.Boolean,vr=e.Date,yr=e.Function,xr=e.Math,mr=e.Number,br=e.Object,_r=e.RegExp,Er=e.String,Tr=e.TypeError,Sr=[],Ir=br.prototype,Rr=e._,wr=Ir.toString,Or=_r("^"+Er(wr).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),Lr=xr.ceil,Nr=e.clearTimeout,Cr=xr.floor,kr=yr.prototype.toString,Pr=cn(Pr=br.getPrototypeOf)&&Pr,jr=Ir.hasOwnProperty,Ar=Sr.push,Fr=e.setTimeout,Dr=Sr.splice,Mr=Sr.unshift,Br=function(){try{var e={},n=cn(n=br.defineProperty)&&n,t=n(e,e,e)&&n}catch(r){}return t}(),zr=cn(zr=br.create)&&zr,Hr=cn(Hr=pr.isArray)&&Hr,Ur=e.isFinite,Vr=e.isNaN,Gr=cn(Gr=br.keys)&&Gr,Wr=xr.max,qr=xr.min,Yr=e.parseInt,Xr=xr.random,Qr={};Qr[M]=pr,Qr[B]=gr,Qr[z]=vr,Qr[H]=yr,Qr[V]=br,Qr[U]=mr,Qr[G]=_r,Qr[W]=Er,t.prototype=n.prototype;var Zr=n.support={};Zr.funcDecomp=!cn(e.WinRTError)&&P.test(g),Zr.funcNames="string"==typeof yr.name,n.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:N,variable:"",imports:{_:n}},zr||(x=function(){function n(){}return function(t){if(Cn(t)){n.prototype=t;var r=new n;n.prototype=null}return r||e.Object()}}());var Kr=Br?function(e,n){X.value=n,Br(e,"__bindData__",X)}:nr,$r=Hr||function(e){return e&&"object"==typeof e&&"number"==typeof e.length&&wr.call(e)==M||!1},Jr=function(e){var n,t=e,r=[];if(!t)return r;if(!Q[typeof e])return r;for(n in t)jr.call(t,n)&&r.push(n);return r},ei=Gr?function(e){return Cn(e)?Gr(e):[]}:Jr,ni={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ti=Tn(ni),ri=_r("("+ei(ti).join("|")+")","g"),ii=_r("["+ei(ni).join("")+"]","g"),oi=function(e,n,t){var r,i=e,o=i;if(!i)return o;var u=arguments,a=0,s="number"==typeof t?2:u.length;if(s>3&&"function"==typeof u[s-2])var l=E(u[--s-1],u[s--],2);else s>2&&"function"==typeof u[s-1]&&(l=u[--s]);for(;++a<s;)if(i=u[a],i&&Q[typeof i])for(var c=-1,f=Q[typeof i]&&ei(i),h=f?f.length:0;++c<h;)r=f[c],o[r]=l?l(o[r],i[r]):i[r];return o},ui=function(e,n,t){var r,i=e,o=i;if(!i)return o;for(var u=arguments,a=0,s="number"==typeof t?2:u.length;++a<s;)if(i=u[a],i&&Q[typeof i])for(var l=-1,c=Q[typeof i]&&ei(i),f=c?c.length:0;++l<f;)r=c[l],"undefined"==typeof o[r]&&(o[r]=i[r]);return o},ai=function(e,n,t){var r,i=e,o=i;if(!i)return o;if(!Q[typeof i])return o;n=n&&"undefined"==typeof t?n:E(n,t,3);for(r in i)if(n(i[r],r,e)===!1)return o;return o},si=function(e,n,t){var r,i=e,o=i;if(!i)return o;if(!Q[typeof i])return o;n=n&&"undefined"==typeof t?n:E(n,t,3);for(var u=-1,a=Q[typeof i]&&ei(i),s=a?a.length:0;++u<s;)if(r=a[u],n(i[r],r,e)===!1)return o;return o},li=Pr?function(e){if(!e||wr.call(e)!=V)return!1;var n=e.valueOf,t=cn(n)&&(t=Pr(n))&&Pr(t);return t?e==t||Pr(e)==t:fn(e)}:fn,ci=un(function(e,n,t){jr.call(e,t)?e[t]++:e[t]=1}),fi=un(function(e,n,t){(jr.call(e,t)?e[t]:e[t]=[]).push(n)}),hi=un(function(e,n,t){e[t]=n}),di=et,pi=Xn,gi=cn(gi=vr.now)&&gi||function(){return(new vr).getTime()},vi=8==Yr(T+"08")?Yr:function(e,n){return Yr(Fn(e)?e.replace(C,""):e,n||0)};return n.after=jt,n.assign=oi,n.at=Wn,n.bind=At,n.bindAll=Ft,n.bindKey=Dt,n.chain=lr,n.compact=ht,n.compose=Mt,n.constant=Qt,n.countBy=ci,n.create=vn,n.createCallback=Zt,n.curry=Bt,n.debounce=zt,n.defaults=ui,n.defer=Ht,n.delay=Ut,n.difference=dt,n.filter=Xn,n.flatten=yt,n.forEach=Kn,n.forEachRight=$n,n.forIn=ai,n.forInRight=mn,n.forOwn=si,n.forOwnRight=bn,n.functions=_n,n.groupBy=fi,n.indexBy=hi,n.initial=mt,n.intersection=bt,n.invert=Tn,n.invoke=Jn,n.keys=ei,n.map=et,n.mapValues=Mn,n.max=nt,n.memoize=Vt,n.merge=Bn,n.min=tt,n.omit=zn,n.once=Gt,n.pairs=Hn,n.partial=Wt,n.partialRight=qt,n.pick=Un,n.pluck=di,n.property=tr,n.pull=Tt,n.range=St,n.reject=ot,n.remove=It,n.rest=Rt,n.shuffle=at,n.sortBy=ct,n.tap=cr,n.throttle=Yt,n.times=ur,n.toArray=ft,n.transform=Vn,n.union=Ot,n.uniq=Lt,n.values=Gn,n.where=pi,n.without=Nt,n.wrap=Xt,n.xor=Ct,n.zip=kt,n.zipObject=Pt,n.collect=et,n.drop=Rt,n.each=Kn,n.eachRight=$n,n.extend=oi,n.methods=_n,n.object=Pt,n.select=Xn,n.tail=Rt,n.unique=Lt,n.unzip=kt,Jt(n),n.clone=pn,n.cloneDeep=gn,n.contains=qn,n.escape=Kt,n.every=Yn,n.find=Qn,n.findIndex=pt,n.findKey=yn,n.findLast=Zn,n.findLastIndex=gt,n.findLastKey=xn,n.has=En,n.identity=$t,n.indexOf=xt,n.isArguments=dn,n.isArray=$r,n.isBoolean=Sn,n.isDate=In,n.isElement=Rn,n.isEmpty=wn,n.isEqual=On,n.isFinite=Ln,n.isFunction=Nn,n.isNaN=kn,n.isNull=Pn,n.isNumber=jn,n.isObject=Cn,n.isPlainObject=li,n.isRegExp=An,n.isString=Fn,n.isUndefined=Dn,n.lastIndexOf=Et,n.mixin=Jt,n.noConflict=er,n.noop=nr,n.now=gi,n.parseInt=vi,n.random=rr,n.reduce=rt,n.reduceRight=it,n.result=ir,n.runInContext=g,n.size=st,n.some=lt,n.sortedIndex=wt,n.template=or,n.unescape=ar,n.uniqueId=sr,n.all=Yn,n.any=lt,n.detect=Qn,n.findWhere=Qn,n.foldl=rt,n.foldr=it,n.include=qn,n.inject=rt,Jt(function(){var e={};return si(n,function(t,r){n.prototype[r]||(e[r]=t)}),e}(),!1),n.first=vt,n.last=_t,n.sample=ut,n.take=vt,n.head=vt,si(n,function(e,r){var i="sample"!==r;n.prototype[r]||(n.prototype[r]=function(n,r){var o=this.__chain__,u=e(this.__wrapped__,n,r);return o||null!=n&&(!r||i&&"function"==typeof n)?new t(u,o):u})}),n.VERSION="2.4.1",n.prototype.chain=fr,n.prototype.toString=hr,n.prototype.value=dr,n.prototype.valueOf=dr,Kn(["join","pop","shift"],function(e){var r=Sr[e];n.prototype[e]=function(){var e=this.__chain__,n=r.apply(this.__wrapped__,arguments);return e?new t(n,e):n}}),Kn(["push","reverse","sort","unshift"],function(e){var t=Sr[e];n.prototype[e]=function(){return t.apply(this.__wrapped__,arguments),this}}),Kn(["concat","slice","splice"],function(e){var r=Sr[e];n.prototype[e]=function(){return new t(r.apply(this.__wrapped__,arguments),this.__chain__)}}),n}var v,y=[],x=[],m=0,b=+new Date+"",_=75,E=40,T=" 	\f ﻿\n\r\u2028\u2029 ᠎             　",S=/\b__p \+= '';/g,I=/\b(__p \+=) '' \+/g,R=/(__e\(.*?\)|\b__t\)) \+\n'';/g,w=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,O=/\w*$/,L=/^\s*function[ \n\r\t]+\w/,N=/<%=([\s\S]+?)%>/g,C=RegExp("^["+T+"]*0+(?=.$)"),k=/($^)/,P=/\bthis\b/,j=/['\n\r\t\u2028\u2029\\]/g,A=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setTimeout"],F=0,D="[object Arguments]",M="[object Array]",B="[object Boolean]",z="[object Date]",H="[object Function]",U="[object Number]",V="[object Object]",G="[object RegExp]",W="[object String]",q={};q[H]=!1,q[D]=q[M]=q[B]=q[z]=q[U]=q[V]=q[G]=q[W]=!0;var Y={leading:!1,maxWait:0,trailing:!1},X={configurable:!1,enumerable:!1,value:null,writable:!1},Q={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},Z={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},K=Q[typeof window]&&window||this,$=Q[typeof t]&&t&&!t.nodeType&&t,J=Q[typeof n]&&n&&!n.nodeType&&n,en=J&&J.exports===$&&$,nn=Q[typeof e]&&e;!nn||nn.global!==nn&&nn.window!==nn||(K=nn);var tn=g();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(K._=tn,define(function(){return tn})):$&&J?en?(J.exports=tn)._=tn:$._=tn:K._=tn}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,n,t){"use strict";t.intFromBoolean=function(e){return e?1:0},t.booleanFromInt=function(e){return null===e?!1:e>0}},{}],3:[function(e,n){"use strict";var t=e("../janicek/core"),r=t.def,i=function(e,n,o,u,a,s){var l={a:r(e,1),b:r(n,0),c:r(o,0),d:r(u,1),tx:r(a,0),ty:r(s,0),clone:function(){return i(l.a,l.b,l.c,l.d,l.tx,l.ty)},createGradientBox:function(e,n,r,i,o){if(l.a=e/1638.4,l.d=n/1638.4,t.isUndefinedOrNull(r)||0===r)l.b=l.c=0;else{var u=Math.cos(r),a=Math.sin(r);l.b=a*l.d,l.c=-a*l.a,l.a*=u,l.d*=u}l.tx=t.isUndefinedOrNull(i)?e/2:i+e/2,l.ty=t.isUndefinedOrNull(o)?n/2:o+n/2},setRotation:function(e,n){var r=t.isUndefinedOrNull(n)?1:n;l.a=Math.cos(e)*r,l.c=Math.sin(e)*r,l.b=-l.c,l.d=l.a},invert:function(){var e=l.a*l.d-l.b*l.c;if(0===e)l.a=l.b=l.c=l.d=0,l.tx=-l.tx,l.ty=-l.ty;else{e=1/e;var n=l.d*e;l.d=l.a*e,l.a=n,l.b*=-e,l.c*=-e;var t=-l.a*l.tx-l.c*l.ty;l.ty=-l.b*l.tx-l.d*l.ty,l.tx=t}return this},transformPoint:function(e){return{x:e.x*l.a+e.y*l.c+l.tx,y:e.x*l.b+e.y*l.d+l.ty}},translate:function(e,n){l.tx+=e,l.ty+=n},rotate:function(e){var n=Math.cos(e),t=Math.sin(e),r=l.a*n-l.b*t;l.b=l.a*t+l.b*n,l.a=r;var i=l.c*n-l.d*t;l.d=l.c*t+l.d*n,l.c=i;var o=l.tx*n-l.ty*t;l.ty=l.tx*t+l.ty*n,l.tx=o},scale:function(e,n){l.a*=e,l.b*=n,l.c*=e,l.d*=n,l.tx*=e,l.ty*=n},concat:function(e){var n=l.a*e.a+l.b*e.c;l.b=l.a*e.b+l.b*e.d,l.a=n;var t=l.c*e.a+l.d*e.c;l.d=l.c*e.b+l.d*e.d,l.c=t;var r=l.tx*e.a+l.ty*e.c+e.tx;l.ty=l.tx*e.b+l.ty*e.d+e.ty,l.tx=r},mult:function(e){var n=i();return n.a=l.a*e.a+l.b*e.c,n.b=l.a*e.b+l.b*e.d,n.c=l.c*e.a+l.d*e.c,n.d=l.c*e.b+l.d*e.d,n.tx=l.tx*e.a+l.ty*e.c+e.tx,n.ty=l.tx*e.b+l.ty*e.d+e.ty,n},identity:function(){l.a=1,l.b=0,l.c=0,l.d=1,l.tx=0,l.ty=0},toMozString:function(){var e="matrix(";return e+=l.a+", ",e+=l.b+", ",e+=l.c+", ",e+=l.d+", ",e+=l.tx+"px, ",e+=l.ty+"px)"},toString:function(){var e="matrix(";return e+=l.a+", ",e+=l.b+", ",e+=l.c+", ",e+=l.d+", ",e+=l.tx+", ",e+=l.ty+")"}};return l};n.exports=i},{"../janicek/core":9}],4:[function(e,n){"use strict";n.exports={distanceFromOrigin:function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},distance:function(e,n){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))},interpolate:function(e,n,t){return{x:(e.x-n.x)*t+n.x,y:(e.y-n.y)*t+n.y}},normalize:function(e,n){if(0===e.x&&0===e.y)e.x=n;else{var t=n/Math.sqrt(e.x*e.x+e.y*e.y);e.x*=t,e.y*=t}},add:function(e,n){return{x:n.x+e.x,y:n.y+e.y}},subtract:function(e,n){return{x:e.x-n.x,y:e.y-n.y}},hash:function(e){return e.x+","+e.y}}},{}],5:[function(e,n){"use strict";n.exports=function(e,n,t,r){return{x:e||0,y:n||0,width:t||0,height:r||0}},n.exports.core=function(e){return{left:function(){return e.x},right:function(){return e.x+e.width},top:function(){return e.y},bottom:function(){return e.y+e.height}}}},{}],6:[function(e,n){"use strict";var t=e("../janicek/core").def,r=function(e,n,r,i){this.w=t(i,0),this.x=t(e,0),this.y=t(n,0),this.z=t(r,0)
},i=function(e,n,t,i){return new r(e,n,t,i)};r.prototype={getLength:function(){return Math.abs(i.distance(this,i()))},get length(){return this.getLength()},getLengthSquared:function(){return this.length*this.length},get lengthSquared(){return this.getLengthSquared()},add:function(e){return i(this.x+e.x,this.y+e.y,this.z+e.z)},clone:function(){return i(this.x,this.y,this.z,this.w)},crossProduct:function(e){return i(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x,1)},decrementBy:function(e){this.x-=e.x,this.y-=e.y,this.z-=e.z},dotProduct:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},equals:function(e,n){return n=t(n,!1),this.x===e.x&&this.y===e.y&&this.z===e.z&&(!n||this.w===e.w)},incrementBy:function(e){this.x+=e.x,this.y+=e.y,this.z+=e.z},nearEquals:function(e,n,r){return r=t(r,!1),Math.abs(this.x-e.x)<n&&Math.abs(this.y-e.y)<n&&Math.abs(this.z-e.z)<n&&(!r||Math.abs(this.w-e.w)<n)},negate:function(){this.x*=-1,this.y*=-1,this.z*=-1},normalize:function(){var e=this.length;return 0!==e&&(this.x/=e,this.y/=e,this.z/=e),e},project:function(){this.x/=this.w,this.y/=this.w,this.z/=this.w},scaleBy:function(e){this.x*=e,this.y*=e,this.z*=e},subtract:function(e){return i(this.x-e.x,this.y-e.y,this.z-e.z)},toString:function(){return"Vector3D("+this.x+", "+this.y+", "+this.z+")"}},i.angleBetween=function(e,n){var t=e.clone();t.normalize();var r=n.clone();return r.normalize(),Math.acos(t.dotProduct(r))},i.distance=function(e,n){var t=n.x-e.x,r=n.y-e.y,i=n.z-e.z;return Math.sqrt(t*t+r*r+i*i)},Object.defineProperties(i,{X_AXIS:{get:function(){return i(1,0,0)}}}),Object.defineProperties(i,{Y_AXIS:{get:function(){return i(0,1,0)}}}),Object.defineProperties(i,{Z_AXIS:{get:function(){return i(0,0,1)}}}),n.exports=i},{"../janicek/core":9}],7:[function(e,n){"use strict";n.exports={canvasRender:e("./voronoimap/canvas-render"),islandShape:e("./voronoimap/island-shape"),lava:e("./voronoimap/lava"),map:e("./voronoimap/map"),noisyEdges:e("./voronoimap/noisy-edges"),roads:e("./voronoimap/roads"),style:e("./voronoimap/style"),watersheds:e("./voronoimap/watersheds")}},{"./voronoimap/canvas-render":34,"./voronoimap/island-shape":38,"./voronoimap/lava":39,"./voronoimap/map":40,"./voronoimap/noisy-edges":41,"./voronoimap/roads":42,"./voronoimap/style":43,"./voronoimap/watersheds":44}],8:[function(e,n){"use strict";var t=e("./core"),r=e("lodash");n.exports=function(e){return e=t.def(e,[]),{value:e,get:function(n,t){return r(e[t]).isUndefined()?null:e[t][n]},set:function(n,r,i){return e[r]=t.def(e[r],[]),e[r][n]=i,e},foreachY:function(n){r(e).each(function(e){r(e).isUndefined()||n(e)})},foreachXY:function(n){var t;for(t=0;t<e.length;t++)if(!r(e[t]).isUndefined()){var i;for(i=0;i<e[t].length;i++)if(!r(e[t][i]).isUndefined()){var o=e[t][i];null!==o&&n(i,t,o)}}},any:function(n){var t;for(t=0;t<e.length;t++)if(!r(e[t]).isUndefined()){var i;for(i=0;i<e[t].length;i++)if(!r(e[t][i]).isUndefined()){var o=e[t][i];if(null!==o&&n(o))return{x:i,y:t}}}return null},dimensions:function(){var n=e.length,t=0;return this.foreachY(function(e){t=Math.max(t,e.length)}),{x:t,y:n}}}},n.exports.getIndices=function(e,n,r){return r=r||1,{x:e/r%n,y:t.toInt(e/r/n)}}},{"./core":9,lodash:1}],9:[function(e,n){"use strict";var t=e("lodash");n.exports={def:function(e,n){return t.isUndefined(e)?n:e},toInt:function(e){return 0|e},coalesce:function(){return t.find(arguments,function(e){return!t.isNull(e)&&!t.isUndefined(e)})},isUndefinedOrNull:function(e){return t.isUndefined(e)||t.isNull(e)}}},{lodash:1}],10:[function(e,n,t){"use strict";t.djb2=function(e){var n,t=5381;for(n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n);return t},t.sdbm=function(e){var n,t=0;for(n=0;n<e.length;n++)t=e.charCodeAt(n)+(t<<6)+(t<<16)-t;return t},t.javaHashCode=function(e){var n=0;if(0===e.length)return n;for(var t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n&=n;return n}},{}],11:[function(e,n,t){"use strict";var r=e("./core");t.MAX_COLOR_COMPONENT=255,t.getRedComponent=function(e){return e>>16&255},t.getGreenComponent=function(e){return e>>8&255},t.getBlueComponent=function(e){return 255&e},t.interpolateColor=function(e,n,t){var i=r.toInt((1-t)*(e>>16)+t*(n>>16)),o=r.toInt((1-t)*(e>>8&255)+t*(n>>8&255)),u=r.toInt((1-t)*(255&e)+t*(255&n));return i>255&&(i=255),o>255&&(o=255),u>255&&(u=255),i<<16|o<<8|u},t.colorFraction=function(e){return r.toInt(t.MAX_COLOR_COMPONENT*e)},t.intToHexColor=function(e){return"#"+("00000"+e.toString(16).toUpperCase()).substr(-6)},t.rgb=function(e,n,t){return"rgb("+e+","+n+","+t+")"},t.rgba=function(e,n,t,r){return"rgba("+e+","+n+","+t+","+r+")"},t.rgbF=function(e,n,t){return"rgb("+100*e+"%,"+100*n+"%,"+100*t+"%)"},t.rgbaF=function(e,n,t,r){return"rgba("+100*e+"%,"+100*n+"%,"+100*t+"%,"+r+")"},t.hsl=function(e,n,t){return"hsl("+e+","+100*n+"%,"+100*t+"%)"},t.hsla=function(e,n,t,r){return"hsla("+e+","+100*n+"%,"+100*t+"%,"+r+")"}},{"./core":9}],12:[function(e,n,t){"use strict";var r=e("./array2d"),i=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180,151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180];t.makePerlinNoise=function(e,n,t,o,u,a,s,l){a=a||666,s=s||4,l=l||.5;var c,f,h,d=1/64,p=a=16807*a%2147483647,g=a=16807*a%2147483647,v=a=16807*a%2147483647,y=[],x=[],m=0;for(h=0;s>h;h++)c=Math.pow(2,h),f=Math.pow(l,h),m+=f,y.push(c),x.push(f);m=1/m;var b=r([]),_=t*d+p;o=o*d+g,u=u*d+v;var E;for(E=0;n>E;E++){t=_;var T;for(T=0;e>T;T++){var S=0;for(h=0;s>h;h++){var I=y[h],R=x[h],w=t*I,O=o*I,L=u*I,N=w-w%1,C=O-O%1,k=L-L%1,P=255&N,j=255&C,A=255&k;w-=N,O-=C,L-=k;var F=w*w*w*(w*(6*w-15)+10),D=O*O*O*(O*(6*O-15)+10),M=L*L*L*(L*(6*L-15)+10),B=i[P]+j,z=i[B]+A,H=i[B+1]+A,U=i[P+1]+j,V=i[U]+A,G=i[U+1]+A,W=w-1,q=O-1,Y=L-1,X=15&i[G+1],Q=(0===(1&X)?8>X?W:q:8>X?-W:-q)+(0===(2&X)?4>X?q:12===X?W:Y:4>X?-q:14===X?-W:-Y);X=15&i[H+1];var Z=(0===(1&X)?8>X?w:q:8>X?-w:-q)+(0===(2&X)?4>X?q:12===X?w:Y:4>X?-q:14===X?-w:-Y);X=15&i[V+1];var K=(0===(1&X)?8>X?W:O:8>X?-W:-O)+(0===(2&X)?4>X?O:12===X?W:Y:4>X?-O:14===X?-W:-Y);X=15&i[z+1];var $=(0===(1&X)?8>X?w:O:8>X?-w:-O)+(0===(2&X)?4>X?O:12===X?w:Y:4>X?-O:14===X?-w:-Y);X=15&i[G];var J=(0===(1&X)?8>X?W:q:8>X?-W:-q)+(0===(2&X)?4>X?q:12===X?W:L:4>X?-q:14===X?-W:-L);X=15&i[H];var en=(0===(1&X)?8>X?w:q:8>X?-w:-q)+(0===(2&X)?4>X?q:12===X?w:L:4>X?-q:14===X?-w:-L);X=15&i[V];var nn=(0===(1&X)?8>X?W:O:8>X?-W:-O)+(0===(2&X)?4>X?O:12===X?W:L:4>X?-O:14===X?-W:-L);X=15&i[z];var tn=(0===(1&X)?8>X?w:O:8>X?-w:-O)+(0===(2&X)?4>X?O:12===X?w:L:4>X?-O:14===X?-w:-L);Z+=F*(Q-Z),$+=F*(K-$),en+=F*(J-en),tn+=F*(nn-tn),$+=D*(Z-$),tn+=D*(en-tn),S+=(tn+M*($-tn))*R}var rn=128*(S*m+1);b.set(T,E,4278190080|rn<<16|rn<<8|rn),t+=d}o+=d}return b.value}},{"./array2d":8}],13:[function(e,n,t){"use strict";var r=e("./hash"),i=2147483647,o=16807;t.makeRandomSeed=function(){return Math.floor(Math.random()*i)},t.nextParkMiller=function(e){return e*o%i},t.nextParkMiller31=function(e){var n=16807*(65535&e),t=16807*(e>>>16);return n+=(32767&t)<<16,n+=t>>>15,n>2147483647&&(n-=2147483647),n},t.nextLCG=function(e){return(1103515245*e+12345)%i},t.toFloat=function(e){return e/i},t.toBool=function(e){return t.toFloat(e)>.5},t.toFloatRange=function(e,n,r){return n+(r-n)*t.toFloat(e)},t.toIntRange=function(e,n,r){return Math.round(n-.4999+(r+.4999-(n-.4999))*t.toFloat(e))},t.stringToSeed=function(e){return r.djb2(e)%i},t.randomGenerator=function(e,n){return function(){return e=n(e)}}},{"./hash":10}],14:[function(e,n){"use strict";n.exports={TOP:1,BOTTOM:2,LEFT:4,RIGHT:8,check:function(n,t){t=e("../../as3/rectangle").core(t);var r=0;return n.x===t.left()&&(r|=this.LEFT),n.x===t.right()&&(r|=this.RIGHT),n.y===t.top()&&(r|=this.TOP),n.y===t.bottom()&&(r|=this.BOTTOM),r}}},{"../../as3/rectangle":5}],15:[function(e,n){"use strict";n.exports={vertex:"vertex",site:"site"}},{}],16:[function(e,n){"use strict";var t=e("lodash");n.exports={delaunayLinesForEdges:function(e){var n=[];return t(e).each(function(e){n.push(e.delaunayLine())}),n},selectEdgesForSitePoint:function(e,n){return t(n).filter(function(n){return null!==n.leftSite&&n.leftSite.coord===e||null!==n.rightSite&&n.rightSite.coord===e})},selectNonIntersectingEdges:function(e,n){if(null===e)return n;var r={x:0,y:0};return t(n).filter(function(n){var t=n.makeDelaunayLineBmp(),i=!e.hitTest(r,1,t,r,1);return t.dispose(),i})},visibleLineSegments:function(n){var r=e("./lr"),i=e("../geom/line-segment"),o=[];return t(n).each(function(e){if(e.visible){var n=e.clippedEnds[r.LEFT],t=e.clippedEnds[r.RIGHT];o.push(i(n,t))}}),o}}},{"../geom/line-segment":30,"./lr":23,lodash:1}],17:[function(e,n){"use strict";var t=e("./halfedge"),r=e("./edge");n.exports=function(e,n,i){function o(e){var n;return 0>e||e>=l?null:(n=c[e],null!==n&&n.edge===r.DELETED?(c[e]=null,null):n)}var u={},a=0,s=0,l=0,c=[],f=null;u.getLeftEnd=function(){return f},Object.defineProperties(u,{leftEnd:{get:function(){return u.getLeftEnd()}}});var h=null;return u.getRightEnd=function(){return h},Object.defineProperties(u,{rightEnd:{get:function(){return u.getRightEnd()}}}),u.dispose=function(){for(var e,n=f;n!==h;)e=n,n=n.edgeListRightNeighbor,e.dispose();f=null,h.dispose(),h=null;var t;for(t=0;l>t;t++)c[t]=null;c=null},u.insert=function(e,n){n.edgeListLeftNeighbor=e,n.edgeListRightNeighbor=e.edgeListRightNeighbor,e.edgeListRightNeighbor.edgeListLeftNeighbor=n,e.edgeListRightNeighbor=n},u.remove=function(e){e.edgeListLeftNeighbor.edgeListRightNeighbor=e.edgeListRightNeighbor,e.edgeListRightNeighbor.edgeListLeftNeighbor=e.edgeListLeftNeighbor,e.edge=r.DELETED,e.edgeListLeftNeighbor=e.edgeListRightNeighbor=null},u.edgeListLeftNeighbor=function(e){var n,t;if(n=(e.x-s)/a*l,0>n&&(n=0),n>=l&&(n=l-1),t=o(n),null===t)for(var r=1;;){if(null!==(t=this.getHash(n-r)))break;if(null!==(t=this.getHash(n+r)))break;r++}if(t===this.getLeftEnd()||t!==this.getRightEnd()&&t.isLeftOf(e)){do t=t.edgeListRightNeighbor;while(t!==this.getRightEnd()&&t.isLeftOf(e));t=t.edgeListLeftNeighbor}else do t=t.edgeListLeftNeighbor;while(t!==this.getLeftEnd()&&!t.isLeftOf(e));return n>0&&l-1>n&&(c[n]=t),t},s=e,a=n,l=2*i,c=[],f=t.createDummy(),h=t.createDummy(),f.edgeListLeftNeighbor=null,f.edgeListRightNeighbor=h,h.edgeListLeftNeighbor=f,h.edgeListRightNeighbor=null,c[0]=f,c[l-1]=h,u}},{"./edge":19,"./halfedge":21}],18:[function(e,n){"use strict";var t=e("./criterion"),r=e("./lr"),i=e("./vertex"),o=function(e,n){if(n!==t.vertex&&n!==t.site)throw"Edges: criterion must be Vertex or Site";this.edges=[],this.edgeOrientations=[],e.length>0&&(this.edges=this._reorderEdges(e,n))};o.prototype={edges:null,edgeOrientations:null,dispose:function(){this.edges=null,this.edgeOrientations=null},_reorderEdges:function(e,n){var o,u,a=e.length,s=[],l=0,c=[];o=0,u=e[o],c.push(u),this.edgeOrientations.push(r.LEFT);var f,h;if(n===t.vertex?(f=u.leftVertex,h=u.rightVertex):(f=u.leftSite,h=u.rightSite),f===i.VERTEX_AT_INFINITY||h===i.VERTEX_AT_INFINITY)return[];for(s[o]=!0,++l;a>l;)for(o=1;a>o;o++)if(!s[o]){u=e[o];var d,p;if(n===t.vertex?(d=u.leftVertex,p=u.rightVertex):(d=u.leftSite,p=u.rightSite),d===i.VERTEX_AT_INFINITY||p===i.VERTEX_AT_INFINITY)return[];d===h?(h=p,this.edgeOrientations.push(r.LEFT),c.push(u),s[o]=!0):p===f?(f=d,this.edgeOrientations.unshift(r.LEFT),c.unshift(u),s[o]=!0):d===f?(f=p,this.edgeOrientations.unshift(r.RIGHT),c.unshift(u),s[o]=!0):p===h&&(h=d,this.edgeOrientations.push(r.RIGHT),c.push(u),s[o]=!0),s[o]&&++l}return c}},n.exports=function(e,n){return new o(e,n)}},{"./criterion":15,"./lr":23,"./vertex":27}],19:[function(e,n,t){"use strict";function r(){var e;return s.length>0?(e=s.pop(),e.init()):e=new t.Edge,e}var i=e("../geom/line-segment"),o=e("./lr"),u=e("../../as3/point-core"),a=e("../../as3/rectangle"),s=[],l=0;t.Edge=function(){this._edgeIndex=l++,this.init()},t.Edge.prototype={_delaunayLineBmp:null,getDelaunayLineBmp:function(){return null===this._delaunayLineBmp&&(this._delaunayLineBmp=this.makeDelaunayLineBmp()),this._delaunayLineBmp},get delaunayLineBmp(){return this.getDelaunayLineBmp()},makeDelaunayLineBmp:function(){throw"unimplemented"},delaunayLine:function(){return i(this.leftSite.coord,this.rightSite.coord)},voronoiEdge:function(){return this.visible?i(this.clippedEnds[o.LEFT],this.clippedEnds[o.RIGHT]):i(null,null)},a:null,b:null,c:null,leftVertex:null,rightVertex:null,vertex:function(e){return e===o.LEFT?this.leftVertex:this.rightVertex},setVertex:function(e,n){e===o.LEFT?this.leftVertex=n:this.rightVertex=n},isPartOfConvexHull:function(){return null===this.leftVertex||null===this.rightVertex},sitesDistance:function(){return u.distance(this.leftSite.coord,this.rightSite.coord)},clippedEnds:null,get visible(){return null!==this.clippedEnds},leftSite:null,rightSite:null,site:function(e){return e===o.LEFT?this.leftSite:this.rightSite},_edgeIndex:0,dispose:function(){null!==this._delaunayLineBmp&&(this._delaunayLineBmp.dispose(),this._delaunayLineBmp=null),this.leftVertex=null,this.rightVertex=null,null!==this.clippedEnds&&(this.clippedEnds[o.LEFT]=null,this.clippedEnds[o.RIGHT]=null,this.clippedEnds=null),this.leftSite=null,this.rightSite=null,s.push(this)},toString:function(){return"Edge "+this._edgeIndex+"; sites "+this.leftSite+", "+this.rightSite+"; endVertices "+(null!==this.leftVertex?String(this.leftVertex.vertexIndex):"null")+", "+(null!==this.rightVertex?String(this.rightVertex.vertexIndex):"null")+"::"},clipVertices:function(e){var n,t,r,i,u,s,l=a.core(e),c=e.x,f=e.y,h=l.right(),d=l.bottom();if(1===this.a&&this.b>=0?(n=this.rightVertex,t=this.leftVertex):(n=this.leftVertex,t=this.rightVertex),1===this.a){if(u=f,null!==n&&n.y>f&&(u=n.y),u>d)return;if(r=this.c-this.b*u,s=d,null!==t&&t.y<d&&(s=t.y),f>s)return;if(i=this.c-this.b*s,r>h&&i>h||c>r&&c>i)return;r>h?(r=h,u=(this.c-r)/this.b):c>r&&(r=c,u=(this.c-r)/this.b),i>h?(i=h,s=(this.c-i)/this.b):c>i&&(i=c,s=(this.c-i)/this.b)}else{if(r=c,null!==n&&n.x>c&&(r=n.x),r>h)return;if(u=this.c-this.a*r,i=h,null!==t&&t.x<h&&(i=t.x),c>i)return;if(s=this.c-this.a*i,u>d&&s>d||f>u&&f>s)return;u>d?(u=d,r=(this.c-u)/this.a):f>u&&(u=f,r=(this.c-u)/this.a),s>d?(s=d,i=(this.c-s)/this.a):f>s&&(s=f,i=(this.c-s)/this.a)}this.clippedEnds={},n===this.leftVertex?(this.clippedEnds[o.LEFT]={x:r,y:u},this.clippedEnds[o.RIGHT]={x:i,y:s}):(this.clippedEnds[o.RIGHT]={x:r,y:u},this.clippedEnds[o.LEFT]={x:i,y:s})},init:function(){this.leftSite=null,this.rightSite=null}},t.DELETED=new t.Edge,t.createBisectingEdge=function(e,n){var t,i,o,u,a,s,l;t=n.x-e.x,i=n.y-e.y,o=t>0?t:-t,u=i>0?i:-i,l=e.x*t+e.y*i+.5*(t*t+i*i),o>u?(a=1,s=i/t,l/=t):(s=1,a=t/i,l/=i);var c=r();return c.leftSite=e,c.rightSite=n,e.addEdge(c),n.addEdge(c),c.leftVertex=null,c.rightVertex=null,c.a=a,c.b=s,c.c=l,c},t.compareSitesDistancesMax=function(e,n){var t=e.sitesDistance(),r=n.sitesDistance();return r>t?1:t>r?-1:0},t.compareSitesDistances=function(e,n){return-t.compareSitesDistancesMax(e,n)}},{"../../as3/point-core":4,"../../as3/rectangle":5,"../geom/line-segment":30,"./lr":23}],20:[function(e,n){"use strict";var t=e("./halfedge"),r=e("../../janicek/core");n.exports=function(e,n,i){function o(){var e;for(f=0,h=0,c=[],e=0;d>e;e++)c[e]=t.createDummy(),c[e].nextInPriorityQueue=null}function u(e){var n=r.toInt((e.ystar-p)/g*d);return 0>n&&(n=0),n>=d&&(n=d-1),n}function a(e){return null===c[e].nextInPriorityQueue}function s(){for(;d-1>h&&a(h);)++h}var l={},c=null,f=0,h=0,d=0,p=0,g=0;return l.dispose=function(){var e;for(e=0;d>e;e++)c[e].dispose(),c[e]=null;c=null},l.insert=function(e){var n,t,r=u(e);for(h>r&&(h=r),n=c[r];null!==(t=n.nextInPriorityQueue)&&(e.ystar>t.ystar||e.ystar===t.ystar&&e.vertex.x>t.vertex.x);)n=t;e.nextInPriorityQueue=n.nextInPriorityQueue,n.nextInPriorityQueue=e,++f},l.remove=function(e){var n,t=u(e);if(null!==e.vertex){for(n=c[t];n.nextInPriorityQueue!==e;)n=n.nextInPriorityQueue;n.nextInPriorityQueue=e.nextInPriorityQueue,f--,e.vertex=null,e.nextInPriorityQueue=null,e.dispose()}},l.empty=function(){return 0===f},l.min=function(){s();var e=c[h].nextInPriorityQueue;return{x:e.vertex.x,y:e.ystar}},l.extractMin=function(){var e;return e=c[h].nextInPriorityQueue,c[h].nextInPriorityQueue=e.nextInPriorityQueue,f--,e.nextInPriorityQueue=null,e},p=e,g=n,d=4*i,o(),l}},{"../../janicek/core":9,"./halfedge":21}],21:[function(e,n,t){"use strict";var r=e("../../janicek/core").def,i=e("./lr"),o=[],u=function(e,n){e=r(e,null),n=r(n,null),this.init(e,n)};u.prototype={edgeListLeftNeighbor:null,edgeListRightNeighbor:null,nextInPriorityQueue:null,edge:null,leftRight:null,vertex:null,ystar:0,toString:function(){return"Halfedge (leftRight: "+this.leftRight+"; vertex: "+this.vertex+")"},dispose:function(){null===this.edgeListLeftNeighbor&&null===this.edgeListRightNeighbor&&null===this.nextInPriorityQueue&&(this.edge=null,this.leftRight=null,this.vertex=null,o.push(this))},reallyDispose:function(){this.edgeListLeftNeighbor=null,this.edgeListRightNeighbor=null,this.nextInPriorityQueue=null,this.edge=null,this.leftRight=null,this.vertex=null,o.push(this)},isLeftOf:function(e){var n,t,r,o,u,a,s,l,c,f,h;return n=this.edge.rightSite,t=e.x>n.x,t&&this.leftRight===i.LEFT?!0:t||this.leftRight!==i.RIGHT?(1===this.edge.a?(a=e.y-n.y,u=e.x-n.x,o=!1,!t&&this.edge.b<0||t&&this.edge.b>=0?(r=a>=this.edge.b*u,o=r):(r=e.x+e.y*this.edge.b>this.edge.c,this.edge.b<0&&(r=!r),r||(o=!0)),o||(s=n.x-this.edge.leftSite.x,r=this.edge.b*(u*u-a*a)<s*a*(1+2*u/s+this.edge.b*this.edge.b),this.edge.b<0&&(r=!r))):(h=this.edge.c-this.edge.a*e.x,l=e.y-h,c=e.x-n.x,f=h-n.y,r=l*l>c*c+f*f),this.leftRight===i.LEFT?r:!r):!1},init:function(e,n){return this.edge=e,this.leftRight=n,this.nextInPriorityQueue=null,this.vertex=null,this}},t.create=function(e,n){return o.length>0?o.pop().init(e,n):new u(e,n)},t.createDummy=function(){return t.create(null,null)}},{"../../janicek/core":9,"./lr":23}],22:[function(e,n,t){"use strict";var r=e("lodash"),i=e("../../janicek/core").def,o=e("../geom/line-segment").core,u=e("./node"),a=e("../../as3/point-core");t.find=function(e){if(e.parent===e)return e;var n=t.find(e.parent);return e.parent=n,n},t.kruskal=function(e,n){n=i(n,"minimum");var s={},l=[],c=[];switch(n){case"maximum":e.sort(o.compareLengths);break;default:e.sort(o.compareLengthsMax)}for(var f=e.length-1;f>=0;){var h=e[f];f--;var d,p=s[a.hash(h.p0)];null===p?(p=c.length>0?c.pop():u(),d=p.parent=p,p.treeSize=1,s[a.hash(h.p0)]=p):d=t.find(p);var g,v=s[a.hash(h.p1)];if(null===v?(v=c.length>0?c.pop():u(),g=v.parent=v,v.treeSize=1,s[a.hash(h.p1)]=v):g=t.find(v),d!==g){l.push(h);var y=d.treeSize,x=g.treeSize;y>=x?(g.parent=d,d.treeSize+=x):(d.parent=g,g.treeSize+=y)}}return r(s).each(function(e){c.push(e)}),l}},{"../../as3/point-core":4,"../../janicek/core":9,"../geom/line-segment":30,"./node":24,lodash:1}],23:[function(e,n){"use strict";n.exports={LEFT:"left",RIGHT:"right",other:function(e){return e===this.LEFT?this.RIGHT:this.LEFT}}},{}],24:[function(e,n){"use strict";n.exports=function(){return{parent:null,treeSize:0}},n.exports.pool=[]},{}],25:[function(e,n){"use strict";var t=e("lodash"),r=e("../geom/circle"),i=e("../../janicek/core").def,o=e("../../as3/rectangle"),u=e("./site");n.exports=function(){var e=[],n=0,a=!1,s={};return s.dispose=function(){null!==e&&(t(e).each(function(e){e.dispose()}),e=null)},s.push=function(n){return a=!1,e.push(n)},Object.defineProperties(s,{length:{get:function(){return e.length}}}),s.next=function(){if(a===!1)throw"SiteList::next():  sites have not been sorted";return n<e.length?e[n++]:null},s.getSitesBounds=function(){a===!1&&(u.sortSites(e),n=0,a=!0);var r,i,s,l;return 0===e.length?o(0,0,0,0):(r=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,t(e).each(function(e){e.x<r&&(r=e.x),e.x>i&&(i=e.x)}),s=e[0].y,l=e[e.length-1].y,o(r,s,i-r,l-s))},s.siteColors=function(n){n=i(n,null);var r=[];return t(e).each(function(e){r.push(null!==n?n.getPixel(e.x,e.y):e.color)}),r},s.siteCoords=function(){var n=[];return t(e).each(function(e){n.push(e.coord)}),n},s.circles=function(){var n=[];return t(e).each(function(e){var t=e.nearestEdge(),i=t.isPartOfConvexHull()?0:.5*t.sitesDistance();n.push(r(e.x,e.y,i))}),n},s.regions=function(n){var r=[];return t(e).each(function(e){r.push(e.region(n))}),r},s.nearestSitePoint=function(n,t,r){var i=n.getPixel(t,r);return i>e.length-1?null:e[i].coord},s}},{"../../as3/rectangle":5,"../../janicek/core":9,"../geom/circle":29,"./site":26,lodash:1}],26:[function(e,n,t){"use strict";function r(e,n){return f.distance(e,n)<y}var i=e("lodash"),o=e("./bounds-check"),u=e("./criterion"),a=e("../../janicek/core").def,s=e("./edge"),l=e("./edge-reorderer"),c=e("./lr"),f=e("../../as3/point-core"),h=e("../geom/polygon"),d=e("../../as3/rectangle").core,p=e("./voronoi"),g=e("../geom/winding"),v=[],y=.005,x=function(e,n,t,r){this.init(e,n,t,r)};x.prototype={_coord:null,get coord(){return this._coord},color:0,weight:0,_siteIndex:0,_edges:null,get edges(){return this._edges},_edgeOrientations:null,_region:null,init:function(e,n,t,r){return this._coord=e,this._siteIndex=n,this.weight=t,this.color=r,this._edges=[],this._region=null,this},toString:function(){return"Site "+this._siteIndex+": "+String(this.coord)},dispose:function(){this._coord=null,this._clear(),v.push(this)},_clear:function(){null!==this._edges&&(this._edges=null),null!==this._edgeOrientations&&(this._edgeOrientations=null),null!==this._region&&(this._region=null)},addEdge:function(e){this._edges.push(e)},nearestEdge:function(){return this._edges.sort(s.compareSitesDistances),this._edges[0]},neighborSites:function(){if(null===this._edges||0===this._edges.length)return[];null===this._edgeOrientations&&this._reorderEdges();var e=[];return i.each(this._edges,function(n){e.push(this._neighborSite(n))}),e},_neighborSite:function(e){return this===e.leftSite?e.rightSite:this===e.rightSite?e.leftSite:null},region:function(e){return null===this._edges||0===this._edges.length?[]:(null===this._edgeOrientations&&(this._reorderEdges(),this._region=this._clipToBounds(e),h(this._region).winding()===g.CLOCKWISE&&this._region.reverse()),this._region)},_reorderEdges:function(){var e=l(this._edges,u.vertex);this._edges=e.edges,this._edgeOrientations=e.edgeOrientations,e.dispose()},_clipToBounds:function(e){for(var n=[],t=this._edges.length,r=0,i=null;t>r&&this._edges[r].visible===!1;)++r;if(r===t)return[];i=this._edges[r];var o=this._edgeOrientations[r];n.push(i.clippedEnds[o]),n.push(i.clippedEnds[c.other(o)]);for(var u=r+1;t>u;u++)i=this._edges[u],i.visible!==!1&&this._connect(n,u,e);return this._connect(n,r,e,!0),n},_connect:function(e,n,t,i){i=a(i,!1);var u=e[e.length-1],s=this._edges[n],l=this._edgeOrientations[n],f=s.clippedEnds[l];if(!r(u,f)){if(u.x!==f.x&&u.y!==f.y){var h,p,g=o.check(u,t),v=o.check(f,t);0!==(g&o.RIGHT)?(h=d(t).right(),0!==(v&o.BOTTOM)?(p=d(t).bottom(),e.push({x:h,y:p})):0!==(v&o.TOP)?(p=d(t).top(),e.push({x:h,y:p})):0!==(v&o.LEFT)&&(p=u.y-t.y+f.y-t.y<t.height?d(t).top():d(t).bottom(),e.push({x:h,y:p}),e.push({x:d(t).left(),y:p}))):0!==(g&o.LEFT)?(h=d(t).left(),0!==(v&o.BOTTOM)?(p=d(t).bottom(),e.push({x:h,y:p})):0!==(v&o.TOP)?(p=d(t).top(),e.push({x:h,y:p})):0!==(v&o.RIGHT)&&(p=u.y-t.y+f.y-t.y<t.height?d(t).top():d(t).bottom(),e.push({x:h,y:p}),e.push({x:d(t).right(),y:p}))):0!==(g&o.TOP)?(p=d(t).top(),0!==(v&o.RIGHT)?(h=d(t).right(),e.push({x:h,y:p})):0!==(v&o.LEFT)?(h=d(t).left(),e.push({x:h,y:p})):0!==(v&o.BOTTOM)&&(h=u.x-t.x+f.x-t.x<t.width?d(t).left():d(t).right(),e.push({x:h,y:p}),e.push({x:h,y:d(t).bottom()}))):0!==(g&o.BOTTOM)&&(p=d(t).bottom(),0!==(v&o.RIGHT)?(h=d(t).right(),e.push({x:h,y:p})):0!==(v&o.LEFT)?(h=d(t).left(),e.push({x:h,y:p})):0!==(v&o.TOP)&&(h=u.x-t.x+f.x-t.x<t.width?d(t).left():d(t).right(),e.push({x:h,y:p}),e.push({x:h,y:d(t).top()})))}if(i)return;e.push(f)}var y=s.clippedEnds[c.other(l)];r(e[0],y)||e.push(y)},get x(){return this._coord.x},get y(){return this._coord.y},dist:function(e){return f.distance(e.coord,this.coord)}},t.create=function(e,n,t,r){return v.length>0?v.pop().init(e,n,t,r):new x(e,n,t,r)},t.sortSites=function(e){e.sort(p.compareSiteByYThenX),i(e).each(function(n,t){e[t]._siteIndex=t})}},{"../../as3/point-core":4,"../../as3/rectangle":5,"../../janicek/core":9,"../geom/polygon":31,"../geom/winding":32,"./bounds-check":14,"./criterion":15,"./edge":19,"./edge-reorderer":18,"./lr":23,"./voronoi":28,lodash:1}],27:[function(e,n,t){"use strict";function r(e,n){return isNaN(e)||isNaN(n)?t.VERTEX_AT_INFINITY:i.length>0?i.pop().init(e,n):new u(e,n)}var i=[],o=0,u=function(e,n){this.init(e,n)};u.prototype={_coord:null,get coord(){return this._coord},vertexIndex:0,init:function(e,n){return this._coord={x:e,y:n},this},dispose:function(){this._coord=null,i.push(this)},setIndex:function(){this.vertexIndex=o++},toString:function(){return"Vertex ("+this.vertexIndex+")"},get x(){return this._coord.x},get y(){return this._coord.y}},t.VERTEX_AT_INFINITY=new u(0/0,0/0),t.intersect=function(n,t){var i,o,u,a,s,l,c,f,h=e("./voronoi"),d=e("./lr");return i=n.edge,o=t.edge,null===i||null===o?null:i.rightSite===o.rightSite?null:(s=i.a*o.b-i.b*o.a,s>-1e-10&&1e-10>s?null:(l=(i.c*o.b-o.c*i.b)/s,c=(o.c*i.a-i.c*o.a)/s,h.compareSiteByYThenX(i.rightSite,o.rightSite)<0?(a=n,u=i):(a=t,u=o),f=l>=u.rightSite.x,f&&a.leftRight===d.LEFT||!f&&a.leftRight===d.RIGHT?null:r(l,c)))}},{"./lr":23,"./voronoi":28}],28:[function(e,n,t){"use strict";var r=e("lodash"),i=e("./criterion"),o=e("../../janicek/core"),u=e("../../janicek/core").def,a=e("./delaunay"),s=e("./edge-list"),l=e("./edge"),c=e("./edge-reorderer"),f=e("./halfedge"),h=e("./halfedge-priority-queue"),d=e("./kruskal"),p=e("./lr"),g=e("../../as3/point-core"),v=e("../../polygonal/pm-prng"),y=e("./site-list"),x=e("./site"),m=e("./vertex");t.make=function(e,n,b){function _(e){var n={};r(e).each(function(e){if(r(n).has(g.hash(e)))throw"Duplicate points not supported yet!";n[g.hash(e)]=e})}function E(e,n){for(var t=e.length,r=0;t>r;r++)T(e[r],null!==n?n[r]:0,r)}function T(e,n,t){var r=100*R.nextDouble(),i=x.create(e,t,r,n);w.push(i),O[g.hash(e)]=i}function S(){return r(N).filter(function(e){return e.isPartOfConvexHull()})}function I(){function e(e){var n=e.edge;return null===n?j:n.site(e.leftRight)}function n(e){var n=e.edge;return null===n?j:n.site(p.other(e.leftRight))}var i,u,a,c,d,g,v,y,x,b,_,E,T,S,I=w.getSitesBounds(),R=o.toInt(Math.sqrt(w.length+4)),O=h(I.y,I.height,R),L=s(I.x,I.width,R),k=[],P=[],j=w.next();for(i=w.next();;)if(O.empty()===!1&&(v=O.min()),null!==i&&(O.empty()||t.comparePointByYThenX(i,v)<0))x=L.edgeListLeftNeighbor(i.coord),b=x.edgeListRightNeighbor,u=n(x),S=l.createBisectingEdge(u,i),N.push(S),T=f.create(S,p.LEFT),k.push(T),L.insert(x,T),null!==(g=m.intersect(x,T))&&(P.push(g),O.remove(x),x.vertex=g,x.ystar=g.y+i.dist(g),O.insert(x)),x=T,T=f.create(S,p.RIGHT),k.push(T),L.insert(x,T),null!==(g=m.intersect(T,b))&&(P.push(g),T.vertex=g,T.ystar=g.y+i.dist(g),O.insert(T)),i=w.next();else{if(O.empty()!==!1)break;x=O.extractMin(),_=x.edgeListLeftNeighbor,b=x.edgeListRightNeighbor,E=b.edgeListRightNeighbor,u=e(x),a=n(b),d=x.vertex,d.setIndex(),x.edge.setVertex(x.leftRight,d),b.edge.setVertex(b.leftRight,d),L.remove(x),O.remove(b),L.remove(b),y=p.LEFT,u.y>a.y&&(c=u,u=a,a=c,y=p.RIGHT),S=l.createBisectingEdge(u,a),N.push(S),T=f.create(S,y),k.push(T),L.insert(_,T),S.setVertex(p.other(y),d),null!==(g=m.intersect(_,T))&&(P.push(g),O.remove(_),_.vertex=g,_.ystar=g.y+u.dist(g),O.insert(_)),null!==(g=m.intersect(T,E))&&(P.push(g),T.vertex=g,T.ystar=g.y+u.dist(g),O.insert(T))}O.dispose(),L.dispose(),r(k).each(function(e){e.reallyDispose()}),r(N).each(function(e){e.clipVertices(C.plotBounds)}),r(P).each(function(e){e.dispose()})}var R=v(),w=y(),O={},L=[],N=[],C={};return C.plotBounds=b,C.dispose=function(){var e,n;if(null!==w&&(w.dispose(),w=null),null!==L){for(n=L.length,e=0;n>e;e++)L[e].dispose();L=null}if(null!==N){for(n=N.length,e=0;n>e;e++)N[e].dispose();N=null}C.plotBounds=null,O=null},C.edges=function(){return N},C.region=function(e){var n=O[g.hash(e)];return null===n?[]:n.region(C.plotBounds)},C.neighborSitesForSite=function(e){var n=[],t=O[g.hash(e)];if(null===t)return n;var i=t.neighborSites();return r(i).each(function(e){n.push(e.coord)}),n},C.circles=function(){return w.circles()},C.voronoiBoundaryForSite=function(e){return a.visibleLineSegments(a.selectEdgesForSitePoint(e,N))},C.delaunayLinesForSite=function(e){return a.delaunayLinesForEdges(a.selectEdgesForSitePoint(e,N))},C.voronoiDiagram=function(){return a.visibleLineSegments(N)},C.delaunayTriangulation=function(e){return e=u(e,null),a.delaunayLinesForEdges(a.selectNonIntersectingEdges(e,N))},C.hull=function(){return a.delaunayLinesForEdges(S())},C.hullPointsInOrder=function(){var e=e(),n=[];if(0===e.length)return n;var t=c(e,i.site);e=t.edges;var r=t.edgeOrientations;t.dispose();var o,u,a=e.length;for(u=0;a>u;u++){var s=e[u];o=r[u],n.push(s.site(o).coord)}return n},C.spanningTree=function(e,n){e=u(e,"minimum"),n=u(n,null);var t=a.selectNonIntersectingEdges(n,N),r=a.delaunayLinesForEdges(t);return d.kruskal(r,e)},C.regions=function(){return w.regions(C.plotBounds)},C.siteColors=function(e){return e=u(e,null),w.siteColors(e)},C.nearestSitePoint=function(e,n,t){return w.nearestSitePoint(e,n,t)},C.siteCoords=function(){return w.siteCoords()},_(e),R.seed=1,E(e,n),I(),C},t.isInfSite=function(e,n){return e.y<n.y||e.y===n.y&&e.x<n.x},t.comparePointByYThenX=function(e,n){return t.compareByYThenX(e.x,e.y,n.x,n.y)},t.compareSiteByYThenX=function(e,n){return t.compareByYThenX(e.x,e.y,n.x,n.y)},t.compareByYThenX=function(e,n,t,r){return r>n?-1:n>r?1:t>e?-1:e>t?1:0}},{"../../as3/point-core":4,"../../janicek/core":9,"../../polygonal/pm-prng":33,"./criterion":15,"./delaunay":16,"./edge":19,"./edge-list":17,"./edge-reorderer":18,"./halfedge":21,"./halfedge-priority-queue":20,"./kruskal":22,"./lr":23,"./site":26,"./site-list":25,"./vertex":27,lodash:1}],29:[function(e,n){"use strict";n.exports=function(e,n,t){return{center:{x:e,y:n},radius:t,toString:function(){return"Circle (center: "+this.center+"; radius: "+this.radius+")"}}}},{}],30:[function(e,n){"use strict";var t=e("../../as3/point-core");n.exports=function(e,n){return{p0:e,p1:n}},n.exports.core={compareLengthsMax:function(e,n){var r=t.distance(e.p0,e.p1),i=t.distance(n.p0,n.p1);return i>r?1:r>i?-1:0},compareLengths:function(e,n){return-this.compareLengthsMax(e,n)}}},{"../../as3/point-core":4}],31:[function(e,n){"use strict";var t=e("./winding"),r=function(e){this._vertices=e};r.prototype={area:function(){return Math.abs(.5*this.signedDoubleArea())
},winding:function(){var e=this.signedDoubleArea();return 0>e?t.CLOCKWISE:e>0?t.COUNTERCLOCKWISE:t.NONE},signedDoubleArea:function(){var e,n,t,r,i=this._vertices.length,o=0;for(e=0;i>e;e++)n=(e+1)%i,t=this._vertices[e],r=this._vertices[n],o+=t.x*r.y-r.x*t.y;return o}},n.exports=function(e){return new r(e)}},{"./winding":32}],32:[function(e,n){"use strict";n.exports={CLOCKWISE:"clockwise",COUNTERCLOCKWISE:"counterclockwise",NONE:"none"}},{}],33:[function(e,n){"use strict";n.exports=function(){return{seed:1,nextDouble:function(){return this.gen()/2147483647},nextIntRange:function(e,n){return e-=.4999,n+=.4999,Math.round(e+(n-e)*this.nextDouble())},nextDoubleRange:function(e,n){return e+(n-e)*this.nextDouble()},gen:function(){return this.seed=16807*this.seed%2147483647,this.seed}}}},{}],34:[function(e,n,t){"use strict";function r(e,n){for(var t=0;t<n.length;t++)e.lineTo(n[t].x,n[t].y)}function i(e,n,t,r,i,o,s,l){var f=c(),d=n.add(t).add(r);d.scaleBy(1/3);var p=t.subtract(n).crossProduct(r.subtract(n));p.normalize();var g=h(-p.x/p.z,-p.y/p.z,0),v=h(d.x-g.x*((d.z-.5)/g.length/g.length),d.y-g.y*((d.z-.5)/g.length/g.length));if(g.length<1e-6){var y=i[0];2===i.length?y=a.interpolateColor(i[0],i[1],d.z):3===i.length&&(y=d.z<.5?a.interpolateColor(i[0],i[1],2*d.z):a.interpolateColor(i[1],i[2],2*d.z-1)),e.fillStyle=a.intToHexColor(y)}else{f.createGradientBox(1,1,0,0,0),f.translate(-.5,-.5),f.scale(1/g.length,1/g.length),f.rotate(Math.atan2(g.y,g.x)),f.translate(v.x,v.y);{u(i).map(function(){return 1}),u(i).map(function(e,n){return 255*n/(i.length-1)})}}o(e,s,l),e.fill()}function o(e,n){for(var t=n.length-1;t>=0;)e.lineTo(n[t].x,n[t].y),t--}var u=e("lodash"),a=e("../janicek/html-color"),s=e("../as3/conversion-core"),l=e("../janicek/core"),c=e("../as3/matrix"),f=e("../as3/point-core"),h=e("../as3/vector-3d");t.graphicsReset=function(e,n,t,r){e.lineWidth=1,e.clearRect(0,0,2e3,2e3),e.fillStyle="#bbbbaa",e.fillRect(0,0,2e3,2e3),e.fillStyle=a.intToHexColor(r.OCEAN),e.fillRect(0,0,l.toInt(n),l.toInt(t))};var d=h(-1,-1,0);t.calculateLighting=function(e,n,t){var r=h(e.point.x,e.point.y,e.elevation),i=h(n.point.x,n.point.y,n.elevation),o=h(t.point.x,t.point.y,t.elevation),u=i.subtract(r).crossProduct(o.subtract(r));u.z<0&&u.scaleBy(-1),u.normalize();var a=.5+35*u.dotProduct(d);return 0>a&&(a=0),a>1&&(a=1),a},t.colorWithSlope=function(e,n,r,i,o){var s=i.v0,l=i.v1;if(u.isNull(s)||u.isNull(l))return o.OCEAN;if(n.water)return e;null!==r&&n.water===r.water&&(e=a.interpolateColor(e,o[r.biome],.4));var c=a.interpolateColor(e,3355443,.7),f=a.interpolateColor(e,16777215,.3),h=t.calculateLighting(n,s,l);return.5>h?a.interpolateColor(c,e,2*h):a.interpolateColor(e,f,2*h-1)},t.colorWithSmoothColors=function(e,n,t,r,i){return null!==t&&n.water===t.water&&(e=a.interpolateColor(i[n.biome],i[t.biome],.25)),e},t.renderDebugPolygons=function(e,n,t){var r;0===n.centers.length&&(e.fillStyle="#dddddd",e.fillRect(0,0,l.toInt(n.SIZE.width),l.toInt(n.SIZE.height)),u(n.points).each(function(n){e.beginPath(),e.strokeStyle="#000000",e.fillStyle="#000000",e.arc(n.x,n.y,1.3,Math.PI,2*Math.PI,!1),e.closePath(),e.fill(),e.stroke()})),u(n.centers).each(function(n){r=u.isNull(n.biome)?n.ocean?t.OCEAN:n.water?t.RIVER:16777215:t[n.biome],e.beginPath(),u(n.borders).each(function(t){u.isNull(t.v0)||u.isNull(t.v1)||(e.moveTo(n.point.x,n.point.y),e.lineTo(t.v0.point.x,t.v0.point.y),e.lineTo(t.v1.point.x,t.v1.point.y))}),e.closePath(),e.fillStyle=a.intToHexColor(a.interpolateColor(r,14540253,.2)),e.fill(),u(n.borders).each(function(n){u.isNull(n.v0)||u.isNull(n.v1)||(e.beginPath(),e.moveTo(n.v0.point.x,n.v0.point.y),n.river>0?(e.lineWidth=1,e.strokeStyle=a.intToHexColor(t.RIVER)):(e.lineWidth=.1,e.strokeStyle="#000000"),e.lineTo(n.v1.point.x,n.v1.point.y),e.closePath(),e.stroke())}),e.beginPath(),e.fillStyle=n.water?"#003333":"#000000",e.globalAlpha=.7,e.arc(n.point.x,n.point.y,1.3,Math.PI,2*Math.PI,!1),e.closePath(),e.fill(),e.globalAlpha=1,u(n.corners).each(function(n){e.fillStyle=n.water?"#0000ff":"#009900",e.fillRect(l.toInt(n.point.x-.7),l.toInt(n.point.y-.7),l.toInt(1.5),l.toInt(1.5))})})},t.renderWatersheds=function(e,n,t){var r,i,o;u(n.edges).each(function(r){u.isNull(r.d0)||u.isNull(r.d1)||u.isNull(r.v0)||u.isNull(r.v1)||r.d0.ocean||r.d1.ocean||(i=t.watersheds[r.d0.index],o=t.watersheds[r.d1.index],i!==o&&(e.beginPath(),e.lineWidth=3.5,e.strokeStyle=a.rgba(0,0,0,.1*Math.sqrt(l.coalesce(n.corners[i].watershedSize,1)+l.coalesce(n.corners[o].watershed.watershedSize,1))),e.moveTo(r.v0.point.x,r.v0.point.y),e.lineTo(r.v1.point.x,r.v1.point.y),e.closePath(),e.stroke()))});for(r in n.edges)s.booleanFromInt(r.river)&&(e.beginPath(),e.lineWidth=1,e.strokeStyle="#6699ff",e.moveTo(r.v0.point.x,r.v0.point.y),e.lineTo(r.v1.point.x,r.v1.point.y),e.closePath(),e.stroke())},t.renderPolygons=function(e,n,t,o,u,s){e.fillStyle=a.intToHexColor(n.OCEAN),e.fillRect(0,0,l.toInt(u.SIZE.width),l.toInt(u.SIZE.height));for(var c=function(e,n,t){var i=s.path0[y.index];e.moveTo(n,t),e.lineTo(i[0].x,i[0].y),r(e,i),e.lineTo(n,t)},f=function(e,n,t){var i=s.path1[y.index];e.moveTo(n,t),e.lineTo(i[0].x,i[0].y),r(e,i),e.lineTo(n,t)},d=0;d<u.centers.length;d++)for(var p=u.centers[d],g=0;g<p.neighbors.length;g++){var v=p.neighbors[g],y=u.lookupEdgeFromCenter(p,v),x=l.coalesce(n[p.biome],0);if(null!==o&&(x=o(x,p,v,y,n)),!l.isUndefinedOrNull(s.path0[y.index])&&!l.isUndefinedOrNull(s.path1[y.index]))if(l.isUndefinedOrNull(t))e.fillStyle=a.intToHexColor(x),e.strokeStyle=e.fillStyle,e.beginPath(),c(e,p.point.x,p.point.y),f(e,p.point.x,p.point.y),e.closePath(),e.fill(),e.stroke();else{var m=y.v0,b=y.v1,_=y.midpoint,E=.5*(m[t]+b[t]);i(e,h(p.point.x,p.point.y,p[t]),h(m.point.x,m.point.y,m[t]),h(_.x,_.y,E),[n.GRADIENT_LOW,n.GRADIENT_HIGH],c,p.point.x,p.point.y),i(e,h(p.point.x,p.point.y,p[t]),h(_.x,_.y,E),h(b.point.x,b.point.y,b[t]),[n.GRADIENT_LOW,n.GRADIENT_HIGH],f,p.point.x,p.point.y)}}},t.renderBridges=function(e,n,t,r){u(n.edges).each(function(n){if(n.river>0&&n.river<4&&!n.d0.water&&!n.d1.water&&(n.d0.elevation>.05||n.d1.elevation>.05)){var i={x:-(n.v1.point.y-n.v0.point.y),y:n.v1.point.x-n.v0.point.x};f.normalize(i,.25+(u.isNull(t.road[n.index])?0:.5)+.75*Math.sqrt(n.river)),e.beginPath(),e.lineWidth=1.1,e.strokeStyle=a.intToHexColor(r.BRIDGE),e.lineCap="square",e.moveTo(n.midpoint.x-i.x,n.midpoint.y-i.y),e.lineTo(n.midpoint.x+i.x,n.midpoint.y+i.y),e.closePath(),e.stroke()}})},t.renderRoads=function(e,n,t,r){function i(e,n,t){var r={x:-(e.v1.point.y-e.v0.point.y),y:e.v1.point.x-e.v0.point.x},i=f.subtract(n,e.midpoint);return r.x*i.x+r.y*i.y<0&&(r.x=-r.x,r.y=-r.y),f.normalize(r,t),r}var o,s,c,h,d,p,g,v,y;u(n.centers).each(function(n){if(!l.isUndefinedOrNull(t.roadConnections[n.index]))if(2===t.roadConnections[n.index].length){for(y=n.borders,h=0;h<y.length;h++)if(g=y[h],t.road[g.index]>0)for(d=h+1;d<y.length;d++)v=y[d],t.road[v.index]>0&&(p=.5*Math.min(f.distanceFromOrigin(f.subtract(g.midpoint,n.point)),f.distanceFromOrigin(f.subtract(v.midpoint,n.point))),o=f.add(i(g,n.point,p),g.midpoint),s=f.add(i(v,n.point,p),v.midpoint),c=f.interpolate(o,s,.5),e.beginPath(),e.lineWidth=1.1,e.strokeStyle=a.intToHexColor(r["ROAD"+t.road[g.index]]),e.moveTo(g.midpoint.x,g.midpoint.y),e.quadraticCurveTo(o.x,o.y,c.x,c.y),e.moveTo(c.x,c.y),e.lineWidth=1.1,e.strokeStyle=a.intToHexColor(r["ROAD"+t.road[v.index]]),e.quadraticCurveTo(s.x,s.y,v.midpoint.x,v.midpoint.y),e.stroke(),e.closePath())}else u(n.borders).each(function(u){t.road[u.index]>0&&(p=.25*f.distanceFromOrigin(f.subtract(u.midpoint,n.point)),o=f.add(i(u,n.point,p),u.midpoint),e.beginPath(),e.lineWidth=1.4,e.strokeStyle=a.intToHexColor(r["ROAD"+t.road[u.index]]),e.moveTo(u.midpoint.x,u.midpoint.y),e.quadraticCurveTo(o.x,o.y,n.point.x,n.point.y),e.stroke(),e.closePath())})})},t.renderEdges=function(e,n,t,i,u,c){c=l.def(c,!0);for(var f,h=0;h<t.centers.length;h++)for(var d=t.centers[h],p=0;p<d.neighbors.length;p++){var g=d.neighbors[p];if(f=t.lookupEdgeFromCenter(d,g),!l.isUndefinedOrNull(i.path0[f.index])&&!l.isUndefinedOrNull(i.path1[f.index])){if(d.ocean!==g.ocean)e.lineWidth=2,e.strokeStyle=a.intToHexColor(n.COAST);else if(s.intFromBoolean(d.water)>0!=s.intFromBoolean(g.water)>0&&"ICE"!==d.biome&&"ICE"!==g.biome)e.lineWidth=1,e.strokeStyle=a.intToHexColor(n.LAKESHORE);else{if(d.water||g.water)continue;if(u.lava[f.index])e.lineWidth=1,e.strokeStyle=a.intToHexColor(n.LAVA);else{if(!(f.river>0&&c))continue;e.lineWidth=Math.sqrt(f.river),e.strokeStyle=a.intToHexColor(n.RIVER)}}e.beginPath(),e.moveTo(i.path0[f.index][0].x,i.path0[f.index][0].y),r(e,i.path0[f.index]),o(e,i.path1[f.index]),e.stroke(),e.closePath()}}},t.renderAllEdges=function(e,n,t,i){var u;e.lineWidth=5,e.strokeStyle=n;for(var a=0;a<t.centers.length;a++)for(var s=t.centers[a],c=0;c<s.neighbors.length;c++){var f=s.neighbors[c];u=t.lookupEdgeFromCenter(s,f),l.isUndefinedOrNull(i.path0[u.index])||l.isUndefinedOrNull(i.path1[u.index])||s.water||(e.beginPath(),e.moveTo(i.path0[u.index][0].x,i.path0[u.index][0].y),r(e,i.path0[u.index]),o(e,i.path1[u.index]),e.stroke(),e.closePath())}}},{"../as3/conversion-core":2,"../as3/matrix":3,"../as3/point-core":4,"../as3/vector-3d":6,"../janicek/core":9,"../janicek/html-color":11,lodash:1}],35:[function(e,n){"use strict";n.exports=function(){return{index:null,point:null,water:null,ocean:null,coast:null,border:null,biome:null,elevation:null,moisture:null,neighbors:null,borders:null,corners:null}}},{}],36:[function(e,n){"use strict";n.exports=function(){return{index:null,point:null,ocean:null,water:null,coast:null,border:null,elevation:null,moisture:null,touches:null,protrudes:null,adjacent:null,river:null,downslope:null,watershed:null,watershedSize:null}}},{}],37:[function(e,n){"use strict";n.exports=function(){return{index:0,d0:null,d1:null,v0:null,v1:null,midpoint:null,river:0}}},{}],38:[function(e,n,t){"use strict";var r=e("../janicek/array2d"),i=e("../janicek/core"),o=e("../as3/point-core").distanceFromOrigin,u=e("../janicek/perlin-noise"),a=e("../polygonal/pm-prng"),s=e("../janicek/pseudo-random-number-generators");t.makeRadial=function(e,n){function t(e){var t=Math.atan2(e.y,e.x),r=.5*(Math.max(Math.abs(e.x),Math.abs(e.y))+o(e)),i=.5+.4*Math.sin(s+u*t+Math.cos((u+3)*t)),a=.7-.2*Math.sin(s+u*t-Math.sin((u+2)*t));return(Math.abs(t-l)<c||Math.abs(t-l+2*Math.PI)<c||Math.abs(t-l-2*Math.PI)<c)&&(i=a=.2),i>r||r>i*n&&a>r}n=i.def(n,1.07);var r=a();r.seed=e;var u=r.nextIntRange(1,6),s=r.nextDoubleRange(0,2*Math.PI),l=r.nextDoubleRange(0,2*Math.PI),c=r.nextDoubleRange(.2,.7);return t},t.makePerlin=function(e,n){n=i.def(n,.5);var t=.1,a=.5;n=(a-t)*n+t;var s=r(u.makePerlinNoise(256,256,1,1,1,e,8));return function(e){var t=(255&s.get(i.toInt(128*(e.x+1)),i.toInt(128*(e.y+1))))/255;return t>n+n*o(e)*o(e)}},t.makeSquare=function(){return function(){return!0}},t.makeBlob=function(){return function(e){var n=o({x:e.x-.2,y:e.y/2+.2})<.05,t=o({x:e.x+.2,y:e.y/2+.2})<.05,r=o(e)<.8-.18*Math.sin(5*Math.atan2(e.y,e.x));return r&&!n&&!t}},t.makeBitmap=function(e){e=r(e);var n=e.dimensions();return function(t){var r=i.toInt((t.x+1)/2*n.x),o=i.toInt((t.y+1)/2*n.y);return e.get(r,o)}},t.makeNoise=function(e){return function(){return e=s.nextParkMiller(e),s.toBool(e)}}},{"../as3/point-core":4,"../janicek/array2d":8,"../janicek/core":9,"../janicek/perlin-noise":12,"../janicek/pseudo-random-number-generators":13,"../polygonal/pm-prng":33}],39:[function(e,n,t){"use strict";var r=e("lodash"),i=e("../as3/conversion-core");n.exports=function(){return{lava:[],createLava:function(e,n){r(e.edges).each(function(e){!i.booleanFromInt(e.river)&&!e.d0.water&&!e.d1.water&&e.d0.elevation>.8&&e.d1.elevation>.8&&e.d0.moisture<.3&&e.d1.moisture<.3&&n()<t.FRACTION_LAVA_FISSURES&&(this.lava[e.index]=!0)})}}},n.exports.FRACTION_LAVA_FISSURES=.2},{"../as3/conversion-core":2,lodash:1}],40:[function(e,n){"use strict";var t=e("lodash"),r=e("./graph/center"),i=e("../as3/conversion-core"),o=e("./graph/corner"),u=e("../janicek/core"),a=e("./graph/edge"),s=e("../polygonal/pm-prng"),l=e("../as3/point-core"),c=e("../as3/rectangle"),f=e("../nodename/delaunay/voronoi"),h=function(e){var n={};return n.SIZE=e,n.islandShape=null,n.mapRandom=s(),n.points=[],n.centers=[],n.corners=[],n.edges=[],n.newIsland=function(e,t){n.islandShape=e,n.mapRandom.seed=t},n.go0PlacePoints=function(e){e=u.def(e,h.DEFAULT_NUMBER_OF_POINTS),n.reset(),n.points=n.generateRandomPoints(e)},n.go1ImprovePoints=function(e){e=u.def(e,h.DEFAULT_LLOYD_ITERATIONS),n.improveRandomPoints(n.points,e)},n.go2BuildGraph=function(){var e=f.make(n.points,null,c(0,0,n.SIZE.width,n.SIZE.height));n.buildGraph(n.points,e),n.improveCorners(),e.dispose(),e=null,n.points=null},n.go3AssignElevations=function(e){e=u.def(e,h.DEFAULT_LAKE_THRESHOLD),n.assignCornerElevations(),n.assignOceanCoastAndLand(e),n.redistributeElevations(n.landCorners(n.corners)),t(n.corners).each(function(e){(e.ocean||e.coast)&&(e.elevation=0)}),n.assignPolygonElevations()},n.go4AssignMoisture=function(e){e=u.def(e,null),n.calculateDownslopes(),n.calculateWatersheds(),n.createRivers(e),n.assignCornerMoisture(),n.redistributeMoisture(n.landCorners(n.corners)),n.assignPolygonMoisture()},n.go5DecorateMap=function(){n.assignBiomes()},n.reset=function(){null!==n.points&&n.points.splice(0,n.points.length),null!==n.edges&&(t(n.edges).each(function(e){e.d0=e.d1=null,e.v0=e.v1=null}),n.edges.splice(0,n.edges.length)),null!==n.centers&&(t(n.centers).each(function(e){e.neighbors.splice(0,e.neighbors.length),e.corners.splice(0,e.corners.length),e.borders.splice(0,e.borders.length)}),n.centers.splice(0,n.centers.length)),null!==n.corners&&(t(n.corners).each(function(e){e.adjacent.splice(0,e.adjacent.length),e.touches.splice(0,e.touches.length),e.protrudes.splice(0,e.protrudes.length),e.downslope=null,e.watershed=null}),n.corners.splice(0,n.corners.length)),null===n.points&&(n.points=[]),null===n.edges&&(n.edges=[]),null===n.centers&&(n.centers=[]),null===n.corners&&(n.corners=[])},n.generateRandomPoints=function(e){var t,r,i=[];for(r=0;e>r;r++)t={x:n.mapRandom.nextDoubleRange(10,n.SIZE.width-10),y:n.mapRandom.nextDoubleRange(10,n.SIZE.height-10)},i.push(t);return i},n.improveRandomPoints=function(e,t){var r,i,o;for(r=0;t>r;r++){i=f.make(e,null,c(0,0,n.SIZE.width,n.SIZE.height));for(var u=0;u<e.length;u++){var a=e[u];o=i.region(a),a.x=0,a.y=0;for(var s=0;s<o.length;s++){var l=o[s];a.x+=l.x,a.y+=l.y}a.x/=o.length,a.y/=o.length,o.splice(0,o.length)}i.dispose()}},n.improveCorners=function(){var e,r,i=[];for(t(n.corners).each(function(n){n.border?i[n.index]=n.point:(e={x:0,y:0},t(n.touches).each(function(n){e.x+=n.point.x,e.y+=n.point.y}),e.x/=n.touches.length,e.y/=n.touches.length,i[n.index]=e)}),r=0;r<n.corners.length;r++)n.corners[r].point=i[r];t(n.edges).each(function(e){null!==e.v0&&null!==e.v1&&(e.midpoint=l.interpolate(e.v0.point,e.v1.point,.5))})},n.landCorners=function(e){var n=[];return t(e).each(function(e){e.ocean||e.coast||n.push(e)}),n},n.buildGraph=function(e,i){function s(e){var t;if(null===e)return null;var r;for(r=u.toInt(e.x)-1;r<u.toInt(e.x)+2;r++)if(!u.isUndefinedOrNull(d[r]))for(var i=0;i<d[r].length;i++){t=d[r][i];var a=e.x-t.point.x,s=e.y-t.point.y;if(1e-6>a*a+s*s)return t}return r=u.toInt(e.x),u.isUndefinedOrNull(d[r])&&(d[r]=[]),t=o(),t.index=n.corners.length,n.corners.push(t),t.point=e,t.border=0===e.x||e.x===n.SIZE.width||0===e.y||e.y===n.SIZE.height,t.touches=[],t.protrudes=[],t.adjacent=[],d[r].push(t),t}var c,f=i.edges(),h={};t(e).each(function(e){c=r(),c.index=n.centers.length,c.point=e,c.neighbors=[],c.borders=[],c.corners=[],n.centers.push(c),h[l.hash(e)]=c}),t(n.centers).each(function(e){i.region(e.point)});var d=[];t(f).each(function(e){function t(e,n){null!==n&&e.indexOf(n)<0&&e.push(n)}function r(e,n){null!==n&&e.indexOf(n)<0&&e.push(n)}var i=e.delaunayLine(),o=e.voronoiEdge(),u=a();u.index=n.edges.length,u.river=0,n.edges.push(u),u.midpoint=null!==o.p0&&null!==o.p1?l.interpolate(o.p0,o.p1,.5):null,u.v0=s(o.p0),u.v1=s(o.p1),u.d0=h[l.hash(i.p0)],u.d1=h[l.hash(i.p1)],null!==u.d0&&u.d0.borders.push(u),null!==u.d1&&u.d1.borders.push(u),null!==u.v0&&u.v0.protrudes.push(u),null!==u.v1&&u.v1.protrudes.push(u),null!==u.d0&&null!==u.d1&&(r(u.d0.neighbors,u.d1),r(u.d1.neighbors,u.d0)),null!==u.v0&&null!==u.v1&&(t(u.v0.adjacent,u.v1),t(u.v1.adjacent,u.v0)),null!==u.d0&&(t(u.d0.corners,u.v0),t(u.d0.corners,u.v1)),null!==u.d1&&(t(u.d1.corners,u.v0),t(u.d1.corners,u.v1)),null!==u.v0&&(r(u.v0.touches,u.d0),r(u.v0.touches,u.d1)),null!==u.v1&&(r(u.v1.touches,u.d0),r(u.v1.touches,u.d1))})},n.assignCornerElevations=function(){var e=[];for(t(n.corners).each(function(e){e.water=!n.inside(e.point)}),t(n.corners).each(function(n){n.border?(n.elevation=0,e.push(n)):n.elevation=Number.POSITIVE_INFINITY});e.length>0;)for(var r=e.shift(),i=0;i<r.adjacent.length;i++){var o=r.adjacent[i],u=.01+r.elevation;r.water||o.water||(u+=1),u<o.elevation&&(o.elevation=u,e.push(o))}},n.redistributeElevations=function(e){var n,t,r,i=1.1;for(e.sort(function(e,n){return e.elevation>n.elevation?1:e.elevation<n.elevation?-1:e.index>n.index?1:e.index<n.index?-1:0}),n=0;n<e.length;n++)t=n/(e.length-1),r=Math.sqrt(i)-Math.sqrt(i*(1-t)),r>1&&(r=1),e[n].elevation=r},n.redistributeMoisture=function(e){var n;for(e.sort(function(e,n){return e.moisture>n.moisture?1:e.moisture<n.moisture?-1:e.index>n.index?1:e.index<n.index?-1:0}),n=0;n<e.length;n++)e[n].moisture=n/(e.length-1)},n.assignOceanCoastAndLand=function(e){var r,o,u=[];for(t(n.centers).each(function(n){o=0,t(n.corners).each(function(e){e.border&&(n.border=!0,n.ocean=!0,e.water=!0,u.push(n)),e.water&&(o+=1)}),n.water=n.ocean||o>=n.corners.length*e});u.length>0;){r=u.shift();for(var a=0;a<r.neighbors.length;a++){var s=r.neighbors[a];s.water&&!s.ocean&&(s.ocean=!0,u.push(s))}}t(n.centers).each(function(e){var n=0,r=0;t(e.neighbors).each(function(e){n+=i.intFromBoolean(e.ocean),r+=i.intFromBoolean(!e.water)}),e.coast=n>0&&r>0}),t(n.corners).each(function(e){var n=0,r=0;t(e.touches).each(function(e){n+=i.intFromBoolean(e.ocean),r+=i.intFromBoolean(!e.water)}),e.ocean=n===e.touches.length,e.coast=n>0&&r>0,e.water=e.border||r!==e.touches.length&&!e.coast})},n.assignPolygonElevations=function(){var e;t(n.centers).each(function(n){e=0,t(n.corners).each(function(n){e+=n.elevation}),n.elevation=e/n.corners.length})},n.calculateDownslopes=function(){var e;t(n.corners).each(function(n){e=n,t(n.adjacent).each(function(n){n.elevation<=e.elevation&&(e=n)}),n.downslope=e})},n.calculateWatersheds=function(){var e,r,i;t(n.corners).each(function(e){e.watershed=e,e.ocean||e.coast||(e.watershed=e.downslope)});var o,u;for(r=0;100>r;r++){for(i=!1,o=0;o<n.corners.length;o++)u=n.corners[o],u.ocean||u.coast||u.watershed.coast||(e=u.downslope.watershed,e.ocean||(u.watershed=e),i=!0);if(!i)break}for(o=0;o<n.corners.length;o++)u=n.corners[o],e=u.watershed,e.watershedSize=1+(e.watershedSize||0)},n.createRivers=function(e){e=u.coalesce(e,u.toInt((n.SIZE.width+n.SIZE.height)/4));var t,r,i;for(t=0;e>t;t++)if(r=n.corners[n.mapRandom.nextIntRange(0,n.corners.length-1)],!(r.ocean||r.elevation<.3||r.elevation>.9))for(;!r.coast&&r!==r.downslope;)i=n.lookupEdgeFromCorner(r,r.downslope),i.river=i.river+1,r.river=(r.river||0)+1,r.downslope.river=(r.downslope.river||0)+1,r=r.downslope},n.assignCornerMoisture=function(){var e,r,i=[];for(t(n.corners).each(function(e){(e.water||e.river>0)&&!e.ocean?(e.moisture=e.river>0?Math.min(3,.2*e.river):1,i.push(e)):e.moisture=0});i.length>0;){e=i.shift();for(var o=0;o<e.adjacent.length;o++){var u=e.adjacent[o];r=.9*e.moisture,r>u.moisture&&(u.moisture=r,i.push(u))}}t(n.corners).each(function(e){(e.ocean||e.coast)&&(e.moisture=1)})},n.assignPolygonMoisture=function(){var e;t(n.centers).each(function(n){e=0,t(n.corners).each(function(n){n.moisture>1&&(n.moisture=1),e+=n.moisture}),n.moisture=e/n.corners.length})},n.assignBiomes=function(){t(n.centers).each(function(e){e.biome=h.getBiome(e)})},n.lookupEdgeFromCenter=function(e,n){for(var t=0;t<e.borders.length;t++){var r=e.borders[t];if(r.d0===n||r.d1===n)return r}return null},n.lookupEdgeFromCorner=function(e,n){for(var t=0;t<e.protrudes.length;t++){var r=e.protrudes[t];if(r.v0===n||r.v1===n)return r}return null},n.inside=function(e){return n.islandShape({x:2*(e.x/n.SIZE.width-.5),y:2*(e.y/n.SIZE.height-.5)})},n.reset(),n};h.DEFAULT_LAKE_THRESHOLD=.3,h.DEFAULT_LLOYD_ITERATIONS=2,h.DEFAULT_NUMBER_OF_POINTS=1e3,h.getBiome=function(e){return e.ocean?"OCEAN":e.water?e.elevation<.1?"MARSH":e.elevation>.8?"ICE":"LAKE":e.coast?"BEACH":e.elevation>.8?e.moisture>.5?"SNOW":e.moisture>.33?"TUNDRA":e.moisture>.16?"BARE":"SCORCHED":e.elevation>.6?e.moisture>.66?"TAIGA":e.moisture>.33?"SHRUBLAND":"TEMPERATE_DESERT":e.elevation>.3?e.moisture>.83?"TEMPERATE_RAIN_FOREST":e.moisture>.5?"TEMPERATE_DECIDUOUS_FOREST":e.moisture>.16?"GRASSLAND":"TEMPERATE_DESERT":e.moisture>.66?"TROPICAL_RAIN_FOREST":e.moisture>.33?"TROPICAL_SEASONAL_FOREST":e.moisture>.16?"GRASSLAND":"SUBTROPICAL_DESERT"},h.countLands=function(e){return t(t(e).filter(function(e){return!e.water})).size()},h.tryMutateMapPointsToGetNumberLands=function(e,n,t,r,i,o){t=u.def(t,1e4),r=u.def(r,h.DEFAULT_NUMBER_OF_POINTS),i=u.def(i,h.DEFAULT_LLOYD_ITERATIONS),o=u.def(o,h.DEFAULT_LAKE_THRESHOLD);var a=r,s=Date.now(),l=!1;do{e.go0PlacePoints(a),e.go1ImprovePoints(i),e.go2BuildGraph(),e.go3AssignElevations(o);var c=h.countLands(e.centers);c===n?l=!0:a+=n>c?1:-1}while(!l&&Date.now()-s<t);return e},n.exports=h},{"../as3/conversion-core":2,"../as3/point-core":4,"../as3/rectangle":5,"../janicek/core":9,"../nodename/delaunay/voronoi":28,"../polygonal/pm-prng":33,"./graph/center":35,"./graph/corner":36,"./graph/edge":37,lodash:1}],41:[function(e,n){"use strict";var t=e("lodash"),r=e("../as3/conversion-core"),i=e("../janicek/core"),o=e("../as3/point-core"),u=e("../janicek/pseudo-random-number-generators");n.exports=function(){var e={};return e.path0=[],e.path1=[],e.buildNoisyEdges=function(a,s,l,c){c=i.def(c,.5);var f=u.randomGenerator(l,u.nextParkMiller);t(a.centers).each(function(u){t(u.borders).each(function(t){if(!i.isUndefinedOrNull(t.d0)&&!i.isUndefinedOrNull(t.d1)&&!i.isUndefinedOrNull(t.v0)&&!i.isUndefinedOrNull(t.v1)&&i.isUndefinedOrNull(e.path0[t.index])){var u=c,a=o.interpolate(t.v0.point,t.d0.point,u),l=o.interpolate(t.v0.point,t.d1.point,u),h=o.interpolate(t.v1.point,t.d0.point,u),d=o.interpolate(t.v1.point,t.d1.point,u),p=10;t.d0.biome!==t.d1.biome&&(p=3),t.d0.ocean&&t.d1.ocean&&(p=100),(t.d0.coast||t.d1.coast)&&(p=1),(r.booleanFromInt(t.river)||!i.isUndefinedOrNull(s.lava[t.index]))&&(p=1),e.path0[t.index]=n.exports.buildNoisyLineSegments(f(),t.v0.point,a,t.midpoint,l,p),e.path1[t.index]=n.exports.buildNoisyLineSegments(f(),t.v1.point,d,t.midpoint,h,p)}})})},e},n.exports.buildNoisyLineSegments=function(e,n,t,r,i,a){function s(e,n,t,r){if(!(o.distanceFromOrigin(o.subtract(e,t))<a||o.distanceFromOrigin(o.subtract(n,r))<a)){var i=u.toFloatRange(l(),.2,.8),f=u.toFloatRange(l(),.2,.8),h=o.interpolate(e,r,i),d=o.interpolate(n,t,i),p=o.interpolate(e,n,f),g=o.interpolate(r,t,f),v=o.interpolate(h,d,f),y=1-u.toFloatRange(l(),-.4,.4),x=1-u.toFloatRange(l(),-.4,.4);s(e,o.interpolate(p,n,y),v,o.interpolate(h,r,x)),c.push(v),s(v,o.interpolate(d,t,y),t,o.interpolate(g,r,x))}}var l=u.randomGenerator(e,u.nextParkMiller),c=[];return c.push(n),s(n,t,r,i),c.push(r),c}},{"../as3/conversion-core":2,"../as3/point-core":4,"../janicek/core":9,"../janicek/pseudo-random-number-generators":13,lodash:1}],42:[function(e,n){"use strict";var t=e("lodash"),r=e("../janicek/core");n.exports=function(){var e={};return e.road=[],e.roadConnections=[],e.createRoads=function(n,i){var o,u,a=[],s=[],l=[];for(t(n.centers).each(function(e){(e.coast||e.ocean)&&(l[e.index]=1,a.push(e))});a.length>0;){o=a.shift();for(var c=0;c<o.neighbors.length;c++){var f=o.neighbors[c];for(u=r.coalesce(l[o.index],0);f.elevation>i[u]&&!f.water;)u+=1;u<r.coalesce(l[f.index],999)&&(l[f.index]=u,a.push(f))}}t(n.centers).each(function(e){t(e.corners).each(function(n){s[n.index]=r.toInt(Math.min(r.coalesce(s[n.index],999),r.coalesce(l[e.index],999)))})}),t(n.centers).each(function(n){t(n.borders).each(function(i){t.isNull(i.v0)||t.isNull(i.v1)||s[i.v0.index]===s[i.v1.index]||(e.road[i.index]=r.toInt(Math.min(s[i.v0.index],s[i.v1.index])),r.isUndefinedOrNull(e.roadConnections[n.index])&&(e.roadConnections[n.index]=[]),e.roadConnections[n.index].push(i))})})},e}},{"../janicek/core":9,lodash:1}],43:[function(e,n,t){"use strict";t.displayColors={OCEAN:4473978,COAST:3355482,LAKESHORE:2250120,LAKE:3368601,RIVER:2250120,MARSH:3106406,ICE:10092543,BEACH:10522743,ROAD1:4465169,ROAD2:5583650,ROAD3:6702131,BRIDGE:6842464,LAVA:13382451,SNOW:16777215,TUNDRA:12303274,BARE:8947848,SCORCHED:5592405,TAIGA:10070647,SHRUBLAND:8952183,TEMPERATE_DESERT:13226651,TEMPERATE_RAIN_FOREST:4491349,TEMPERATE_DECIDUOUS_FOREST:6788185,GRASSLAND:8956501,SUBTROPICAL_DESERT:13810059,TROPICAL_RAIN_FOREST:3372885,TROPICAL_SEASONAL_FOREST:5609796},t.elevationGradientColors={OCEAN:34816,GRADIENT_LOW:34816,GRADIENT_HIGH:16776960}},{}],44:[function(e,n){"use strict";var t=e("lodash");n.exports=function(){var e={};return e.lowestCorner=[],e.watersheds=[],e.createWatersheds=function(n){var r;t(n.centers).each(function(n){r=null,t(n.corners).each(function(e){(null===r||e.elevation<r.elevation)&&(r=e)}),e.lowestCorner[n.index]=null===r?-1:r.index,e.watersheds[n.index]=null===r?-1:null===r.watershed?-1:r.watershed.index})},e}},{lodash:1}]},{},[7]);